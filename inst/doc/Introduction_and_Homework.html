<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jianjun Zhang" />

<meta name="date" content="2024-12-01" />

<title>Introduction to R-package named SA24204187</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to R-package named
SA24204187</h1>
<h4 class="author">Jianjun Zhang</h4>
<h4 class="date">2024-12-01</h4>



<div id="introduction-to-sa24204187-r-package" class="section level1">
<h1>Introduction to “SA24204187” R-package</h1>
<p><em>SA24204187</em> is a simple R package developed to compute kinds
of mean estimators of <span class="math inline">\(n\)</span> column
vectors of a design matrix over <span class="math inline">\(\mathbb{R}^{p*n}\)</span>, <span class="math inline">\(p\)</span> is the dimension of random vectors and
<span class="math inline">\(n\)</span> is the number of random vectors.
there are simple mean estimators like <em>empirical.mean</em>,
<em>CG.mean</em>, <em>selectCG.mean</em>, <em>trimmed.mean</em>,
<em>robust.mean</em> and <em>MOM.mean</em>. <em>empirical.mean</em> is a
classical mean estimator with formula <span class="math inline">\(\bar{\mu}_n = \frac{1}{n}\sum^{n}_{i=1}
X_i\)</span>. In addition, there is a iterative algorithm via weighted
mean method to estimate the unknowed sample mean that is robust and can
solve the issue that the data has outliers. Simple mean estimators were
introducted in the document: Lugosi, G., Mendelson, S. Mean Estimation
and Regression Under Heavy-Tailed Distributions: A Survey. Found Comput
Math 19, 1145–1190 (2019). The iterative algorithm was introducted in
the document: Cheng, Yu et al. “High-Dimensional Robust Mean Estimation
via Gradient Descent.” International Conference on Machine Learning
(2020).</p>
<p><em>CG.mean</em> and <em>selectCG.mean</em> are the functions with
the Catoni–Giulini mean estimator. <em>selectCG.mean</em> is the
Catoni–Giulini mean estimator selected by MSE using R. <span class="math display">\[\widehat{\mu}_n=\frac{1}{n} \sum_{i=1}^n X_i \min
\left(1, \frac{1}{\alpha\left\|X_i\right\|}\right),\]</span> where <span class="math inline">\(\alpha &gt; 0\)</span> is a (small) parameter.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(SA24204187)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>random_matrix_normal <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">200</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">CG.mean</span>(random_matrix_normal)</span></code></pre></div>
<pre><code>##   [1]  0.0120659136 -0.0411052932  0.0557145744 -0.0552149858  0.1225425325
##   [6]  0.1131624154 -0.1768134899  0.0254646303  0.0739897473 -0.0661607926
##  [11] -0.0238223680  0.0357172439 -0.1129144437 -0.0001850431  0.0712051968
##  [16] -0.1855913299  0.0433888754 -0.0851469882  0.0064984274  0.0178646614
##  [21]  0.2004052250  0.0955245425  0.0845234924  0.0365278916 -0.0520620387
##  [26]  0.1128909813  0.0832955644  0.0308937001 -0.0828082953 -0.0794421623
##  [31]  0.0801077953  0.0112170424 -0.0352885220 -0.0517480863  0.0275180771
##  [36] -0.1378020002  0.0944690636  0.0692260183  0.0994136417 -0.0399838608
##  [41]  0.1157334862  0.0132430312  0.0644268928  0.0787783387 -0.0301819962
##  [46] -0.0031533697  0.0626422696 -0.0939378768  0.0592422293 -0.1278955951
##  [51] -0.0295593930  0.0791258823  0.0507600507  0.1578696271  0.0259634813
##  [56] -0.0943387426  0.0675293364  0.1400189861  0.1462693019 -0.1890588555
##  [61]  0.1893163127 -0.0747031982 -0.0109389992  0.0741361489 -0.2398167041
##  [66]  0.0336614047 -0.0724070207 -0.0069587849  0.0124787077 -0.0180508484
##  [71] -0.0927555826  0.1856828327 -0.0083194875 -0.0340293453 -0.1563515387
##  [76]  0.0161535599  0.1274031139 -0.0425997895 -0.2391380501 -0.0773719597
##  [81] -0.0697621064  0.0385648780 -0.0538203845 -0.0132059367 -0.0981248951
##  [86]  0.1437885632  0.0323245213 -0.0039154822 -0.1178730698 -0.0254150517
##  [91]  0.0013424015 -0.0370869797  0.1405795441 -0.0348858981  0.1392998231
##  [96] -0.0922805407  0.0049549403 -0.0082643097  0.0243256087 -0.0552446733
## [101] -0.1719131302 -0.0277769530 -0.1234396145 -0.0741021637 -0.0115312372
## [106] -0.0555416109  0.2266024009  0.0074082570 -0.0210925176  0.0260933151
## [111]  0.1731710398  0.1105582942 -0.0218415710  0.0922624942 -0.1417072768
## [116] -0.0043708645  0.0082002822 -0.1492391272 -0.0118416025  0.0358970438
## [121] -0.0501416577 -0.1371380868  0.0099380779  0.0521822652 -0.1060776076
## [126] -0.0168690768  0.1298017133 -0.2474348550 -0.0647638876 -0.0500934010
## [131]  0.1849296889 -0.0969166018 -0.1556029823 -0.1730999335 -0.1840779839
## [136] -0.0630005137  0.0549982171  0.0450464031 -0.0261425334  0.0953939268
## [141] -0.0727185524 -0.0672333628 -0.0586883989  0.0040958147  0.0265014997
## [146] -0.2714708319 -0.0905640659 -0.1093968834 -0.0697067456 -0.0414068835
## [151]  0.1284050243 -0.0037003301 -0.1389989948  0.1041104193  0.0907522558
## [156]  0.1664875666 -0.0514085780 -0.0243530109 -0.1518649192  0.0078665754
## [161]  0.0960704392  0.1027943254 -0.0955994007  0.0779152374 -0.0505107546
## [166] -0.0241022794 -0.1445202360  0.1782452077  0.0212888557 -0.0606254984
## [171]  0.0170275562 -0.2381600659 -0.0578238927  0.0977541932  0.0035848638
## [176] -0.0298914779 -0.0013546645 -0.0416007898  0.1063312032  0.0337300700
## [181]  0.1157702935  0.0588995836 -0.0107721229  0.0125276456 -0.0364178898
## [186]  0.0356665392  0.0555673068 -0.0125589502  0.0668792316 -0.0008931825
## [191] -0.0789833298 -0.1816014496  0.0700596811 -0.0764579160 -0.2439957148
## [196] -0.1173018765  0.0842149932  0.0409392725  0.1473294350  0.1376194729</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">selectCG.mean</span>(random_matrix_normal,<span class="fl">0.05</span>,<span class="dv">20</span>)</span></code></pre></div>
<pre><code>##   [1]  0.0120659136 -0.0411052932  0.0557145744 -0.0552149858  0.1225425325
##   [6]  0.1131624154 -0.1768134899  0.0254646303  0.0739897473 -0.0661607926
##  [11] -0.0238223680  0.0357172439 -0.1129144437 -0.0001850431  0.0712051968
##  [16] -0.1855913299  0.0433888754 -0.0851469882  0.0064984274  0.0178646614
##  [21]  0.2004052250  0.0955245425  0.0845234924  0.0365278916 -0.0520620387
##  [26]  0.1128909813  0.0832955644  0.0308937001 -0.0828082953 -0.0794421623
##  [31]  0.0801077953  0.0112170424 -0.0352885220 -0.0517480863  0.0275180771
##  [36] -0.1378020002  0.0944690636  0.0692260183  0.0994136417 -0.0399838608
##  [41]  0.1157334862  0.0132430312  0.0644268928  0.0787783387 -0.0301819962
##  [46] -0.0031533697  0.0626422696 -0.0939378768  0.0592422293 -0.1278955951
##  [51] -0.0295593930  0.0791258823  0.0507600507  0.1578696271  0.0259634813
##  [56] -0.0943387426  0.0675293364  0.1400189861  0.1462693019 -0.1890588555
##  [61]  0.1893163127 -0.0747031982 -0.0109389992  0.0741361489 -0.2398167041
##  [66]  0.0336614047 -0.0724070207 -0.0069587849  0.0124787077 -0.0180508484
##  [71] -0.0927555826  0.1856828327 -0.0083194875 -0.0340293453 -0.1563515387
##  [76]  0.0161535599  0.1274031139 -0.0425997895 -0.2391380501 -0.0773719597
##  [81] -0.0697621064  0.0385648780 -0.0538203845 -0.0132059367 -0.0981248951
##  [86]  0.1437885632  0.0323245213 -0.0039154822 -0.1178730698 -0.0254150517
##  [91]  0.0013424015 -0.0370869797  0.1405795441 -0.0348858981  0.1392998231
##  [96] -0.0922805407  0.0049549403 -0.0082643097  0.0243256087 -0.0552446733
## [101] -0.1719131302 -0.0277769530 -0.1234396145 -0.0741021637 -0.0115312372
## [106] -0.0555416109  0.2266024009  0.0074082570 -0.0210925176  0.0260933151
## [111]  0.1731710398  0.1105582942 -0.0218415710  0.0922624942 -0.1417072768
## [116] -0.0043708645  0.0082002822 -0.1492391272 -0.0118416025  0.0358970438
## [121] -0.0501416577 -0.1371380868  0.0099380779  0.0521822652 -0.1060776076
## [126] -0.0168690768  0.1298017133 -0.2474348550 -0.0647638876 -0.0500934010
## [131]  0.1849296889 -0.0969166018 -0.1556029823 -0.1730999335 -0.1840779839
## [136] -0.0630005137  0.0549982171  0.0450464031 -0.0261425334  0.0953939268
## [141] -0.0727185524 -0.0672333628 -0.0586883989  0.0040958147  0.0265014997
## [146] -0.2714708319 -0.0905640659 -0.1093968834 -0.0697067456 -0.0414068835
## [151]  0.1284050243 -0.0037003301 -0.1389989948  0.1041104193  0.0907522558
## [156]  0.1664875666 -0.0514085780 -0.0243530109 -0.1518649192  0.0078665754
## [161]  0.0960704392  0.1027943254 -0.0955994007  0.0779152374 -0.0505107546
## [166] -0.0241022794 -0.1445202360  0.1782452077  0.0212888557 -0.0606254984
## [171]  0.0170275562 -0.2381600659 -0.0578238927  0.0977541932  0.0035848638
## [176] -0.0298914779 -0.0013546645 -0.0416007898  0.1063312032  0.0337300700
## [181]  0.1157702935  0.0588995836 -0.0107721229  0.0125276456 -0.0364178898
## [186]  0.0356665392  0.0555673068 -0.0125589502  0.0668792316 -0.0008931825
## [191] -0.0789833298 -0.1816014496  0.0700596811 -0.0764579160 -0.2439957148
## [196] -0.1173018765  0.0842149932  0.0409392725  0.1473294350  0.1376194729</code></pre>
<p><em>trimmed.mean</em> is defined by removing a fraction of the
sample, consisting of the <span class="math inline">\(\epsilon\)</span>
largest and smallest points for some parameter <span class="math inline">\(\epsilon \in (0,1)\)</span> and thenaveraging over
the rest.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">library</span>(SA24204187)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>random_matrix_normal <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">200</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">trimmed.mean</span>(random_matrix_normal)</span></code></pre></div>
<pre><code>##   [1] -0.631733774 -0.333690621  0.524019465  0.821894895  0.463040831
##   [6] -0.452094106  0.015785774  1.369144486 -0.705549293 -0.415233335
##  [11]  0.548903291 -1.732416387 -0.377987905  0.065801424 -0.115882370
##  [16] -0.143493232 -0.105735256 -0.538463895  0.440786812  0.435350144
##  [21]  2.178757306  0.078480593 -0.197228845  0.127689268 -0.399887935
##  [26]  1.072229906  0.160772235 -0.907222381  0.029261094  0.191012525
##  [31]  0.551713635 -1.032632177  0.312292531 -0.437337638  0.364260419
##  [36]  0.045015801  0.372813835  0.786455295 -0.263968982 -0.625723180
##  [41]  0.675438918 -0.571492377  0.872980045 -0.176338839 -0.706178837
##  [46] -0.725512713 -0.759202195  0.636933623 -0.039137240 -0.039734658
##  [51]  0.370992271  0.480823626  0.304053264  1.121326573 -0.426021499
##  [56] -0.411231567 -0.465955908 -0.398899662  0.534447796 -0.670618929
##  [61] -0.200582907 -0.571201083  0.903041637  0.865379328 -1.032212415
##  [66] -0.759064505 -2.296862788  0.630812155 -0.725534073 -0.190088345
##  [71]  0.454668765 -0.371559575 -0.079681899  0.356635077 -0.195487525
##  [76] -1.477190123 -0.660432387 -0.012230246  0.371538653 -0.298710657
##  [81] -0.048412577  1.005045954 -0.011248783  1.000480957 -0.964465698
##  [86]  0.719081295 -0.530297496  0.752658018  0.551342263  0.044774550
##  [91] -0.794143960  0.307186783  0.511108881 -0.413264433  0.188384756
##  [96] -0.296900006 -0.391562310  0.078679689  0.765978163 -0.125195298
## [101] -0.995308292 -0.710124135 -1.069518803 -1.015674814 -0.473343318
## [106] -0.107949147 -1.361496102  0.715189869 -0.494038508 -0.119976373
## [111]  1.669511852 -0.009558007  1.174405773 -0.245859732 -1.208865801
## [116] -0.819132502 -0.174553546  0.174132651  0.068469885 -0.055898041
## [121] -1.357482422 -1.510447162 -0.527140451  0.389805275 -1.566873926
## [126] -0.135462690 -0.296490007 -0.125949168 -0.790935310 -0.160812239
## [131]  1.268295569  0.392433357  0.790709244 -1.372426599  0.117808898
## [136] -0.843604389  1.746945396  0.313040449  0.827460738 -0.801144724
## [141]  1.199267762  0.549710249  0.211860405 -0.766917200  0.829485737
## [146] -0.843388557  0.127562395 -0.238361858 -1.492521316 -0.842516776
## [151] -0.867558720 -1.033830649 -0.322160008  0.362508108  1.365408272
## [156]  1.025497001 -1.112624723  0.358405157  1.078638646  0.518671976
## [161]  0.513526897  0.729206952 -2.169479394  0.493974966  0.110603446
## [166] -0.679228756 -0.354420176 -0.055086662  0.017599277  0.265645468
## [171] -0.617009900 -0.268550416 -0.987224620 -0.578782789 -0.189223196
## [176] -0.178198575 -0.017559379 -1.349220760  0.120859000 -1.196526510
## [181]  0.920526445 -1.076168828 -0.985102084  0.233521876  1.289671420
## [186] -0.092380266 -0.964335586  1.198525724  0.066376018 -0.449174175
## [191]  0.079323982  0.092875816 -0.806620090  0.166699810  0.569122351
## [196]  0.854219947  0.217139995  0.541884606  0.332829965  0.825590478</code></pre>
<p><em>robust.mean</em> is the function of mean estimation that users
can choose variate robust loss functions to solve the mean estimator.
There are kinds of loss functions, such as Huber loss, bisquare loss and
Wang’s loss.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">library</span>(SA24204187)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>random_matrix_normal <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">200</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">robust.mean</span>(random_matrix_normal,<span class="at">method =</span> <span class="st">&quot;huber&quot;</span>) </span></code></pre></div>
<pre><code>##   [1]  0.0107566159 -0.0411031408  0.0542553235 -0.0523101005  0.1218856223
##   [6]  0.1134167766 -0.1792738698  0.0267628452  0.0753621548 -0.0648805620
##  [11] -0.0332634739  0.0443233672 -0.1158989513  0.0029482462  0.0663314478
##  [16] -0.1729021865  0.0390975127 -0.0893648234 -0.0030697498  0.0069202222
##  [21]  0.1935509068  0.1053305638  0.0837378346  0.0279146798 -0.0521719131
##  [26]  0.1144529855  0.0876298989  0.0307930097 -0.0802765678 -0.0776305437
##  [31]  0.0747017693  0.0111944818 -0.0361858822 -0.0500231965  0.0171158967
##  [36] -0.1369967619  0.0884230161  0.0745441722  0.0992008251 -0.0379595388
##  [41]  0.1167943506  0.0176877657  0.0569730855  0.0790935448 -0.0362712436
##  [46] -0.0084216158  0.0644316341 -0.0984829379  0.0614062149 -0.1294928361
##  [51] -0.0267670348  0.0772778573  0.0531399764  0.1644662167  0.0224278645
##  [56] -0.0927344761  0.0701349612  0.1452091166  0.1467166209 -0.1876129073
##  [61]  0.1869937772 -0.0832082838 -0.0019775276  0.0725983926 -0.2294458713
##  [66]  0.0284964663 -0.0636804307  0.0045279390  0.0058273056 -0.0167290148
##  [71] -0.0933622811  0.1815723135 -0.0134900586 -0.0332983135 -0.1563050174
##  [76]  0.0154479288  0.1264262230 -0.0468845749 -0.2456402017 -0.0829975927
##  [81] -0.0662985338  0.0390171420 -0.0557875874 -0.0147975556 -0.0978116920
##  [86]  0.1431268631  0.0304551121 -0.0054526627 -0.1223878841 -0.0213991523
##  [91]  0.0010555194 -0.0420394740  0.1419557173 -0.0398369402  0.1409175138
##  [96] -0.0986028661  0.0050416753 -0.0060586237  0.0252112738 -0.0566935579
## [101] -0.1771509574 -0.0243906639 -0.1156247609 -0.0751052100 -0.0065596051
## [106] -0.0557185156  0.2268720903  0.0032523954 -0.0164525830  0.0244546526
## [111]  0.1749455341  0.1169507196 -0.0260364971  0.0968581371 -0.1441153832
## [116] -0.0113117466  0.0138612390 -0.1487969003 -0.0086002398  0.0322545669
## [121] -0.0449750501 -0.1481092988  0.0108610496  0.0600874354 -0.1070765323
## [126] -0.0074164420  0.1253132995 -0.2474257381 -0.0588405174 -0.0399791134
## [131]  0.1789287620 -0.0984114605 -0.1560437889 -0.1752772624 -0.1849641322
## [136] -0.0531232419  0.0550892737  0.0417438067 -0.0201048202  0.0898262831
## [141] -0.0737735930 -0.0636769538 -0.0690091922 -0.0006990959  0.0263685952
## [146] -0.2718247164 -0.0923773317 -0.1041599005 -0.0709897494 -0.0416239334
## [151]  0.1223309431 -0.0008496793 -0.1367322919  0.1044024498  0.0947749807
## [156]  0.1666874447 -0.0549626865 -0.0177040125 -0.1536179933  0.0077293503
## [161]  0.0918993185  0.1084178607 -0.0964515529  0.0816950496 -0.0537265218
## [166] -0.0291671756 -0.1385272298  0.1773860955  0.0288331923 -0.0572177999
## [171]  0.0112237137 -0.2432898853 -0.0535764426  0.0983181481  0.0014136706
## [176] -0.0299828719  0.0017053695 -0.0331463336  0.1003291360  0.0393743539
## [181]  0.1193478729  0.0564496083 -0.0155365761  0.0209213329 -0.0405832509
## [186]  0.0310174795  0.0478205557 -0.0186713673  0.0691794055 -0.0061812183
## [191] -0.0856603169 -0.1830377932  0.0724550167 -0.0777662179 -0.2487607572
## [196] -0.1155352102  0.0830202513  0.0479128913  0.1403220805  0.1434602771</code></pre>
<p><em>MOM.mean</em> is the function of mean estimation that users can
choose some multivariate medians to solve the mean estimator, such as
coordinate-wise median, geometric (or spatial) median and Euclidean ball
median. Median-of-mean estimator is a mean estimation method: Regardless
of what notion of a multivariate median we decide to adopt, we start by
partitioning <span class="math inline">\([n]=\{1, \ldots, n\}\)</span>
into <span class="math inline">\(k\)</span> blocks <span class="math inline">\(B_1, \ldots, B_k\)</span>, each of size <span class="math inline">\(\left|B_i\right| \geq\lfloor n / k\rfloor \geq
2\)</span>. Here <span class="math inline">\(k\)</span> is a parameter
of the estimator to be chosen later. For simplicity, we assume that
<span class="math inline">\(k m=n\)</span> for some positive integer
<span class="math inline">\(m\)</span>. Just like before, we compute the
sample mean of the random vectors within each block: For <span class="math inline">\(j=1, \ldots, k\)</span>, let <span class="math display">\[Z_j=\frac{1}{m} \sum_{i \in B_j} X_i,\]</span>
then the median of <span class="math inline">\(Z_j\)</span> is the
result of the method.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">library</span>(SA24204187)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>random_matrix_normal <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">200</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">MOM.mean</span>(random_matrix_normal,<span class="at">k =</span> <span class="dv">40</span>,<span class="at">method =</span> <span class="st">&quot;geometric&quot;</span>) </span></code></pre></div>
<pre><code>##   [1]  0.053018240 -0.010598041  0.071094570 -0.088447649  0.086094639
##   [6]  0.042998820 -0.221286540 -0.104878417  0.149922725  0.005530608
##  [11] -0.049526979  0.032362912 -0.218313194 -0.044846214  0.103678461
##  [16] -0.166178289  0.075572079 -0.113394288 -0.035096146  0.036616315
##  [21]  0.095939931  0.175548119  0.053699173  0.024939529 -0.050898797
##  [26]  0.186679900  0.045540222  0.017759948 -0.159234284 -0.103959309
##  [31]  0.138266184 -0.003073114 -0.065637824 -0.012059374  0.017250571
##  [36] -0.179317101  0.103843537  0.002851738  0.041397710 -0.132284524
##  [41]  0.095577189 -0.102377059  0.082448010  0.105583461  0.059943282
##  [46]  0.028087852 -0.010336229 -0.094355080  0.110170512 -0.020183944
##  [51] -0.050794639 -0.042766073 -0.001220826  0.056121274 -0.014996917
##  [56] -0.111607805  0.059229964  0.111518899  0.182430680 -0.283035301
##  [61]  0.244057538 -0.094570199  0.013242677  0.052509517 -0.299893082
##  [66] -0.034158575 -0.066228897 -0.067103949  0.013126821 -0.014280447
##  [71] -0.117895726  0.233024390 -0.077241234 -0.038346871 -0.163683462
##  [76]  0.042728430  0.065030753 -0.097131490 -0.236734743 -0.067185639
##  [81] -0.026403412  0.030698173 -0.081828694 -0.033504463 -0.098762539
##  [86]  0.108434741  0.011379211  0.038368242 -0.146100006 -0.051623302
##  [91] -0.002755123 -0.139447945  0.120549529 -0.075909027  0.107755213
##  [96] -0.061335758 -0.078876752 -0.070486231 -0.024242170 -0.023036444
## [101] -0.206223330 -0.001785030 -0.184608361 -0.131565449 -0.025384342
## [106] -0.071901977  0.199867986 -0.036675987 -0.017890119  0.057344511
## [111]  0.105889830  0.125776181 -0.035073315  0.133811451 -0.097214645
## [116]  0.023434296 -0.096414692 -0.085489633  0.052258621  0.010066907
## [121]  0.038557997 -0.156899081  0.023071815 -0.009526192 -0.055454203
## [126] -0.021231350  0.106517825 -0.194826896 -0.049154892  0.045371612
## [131]  0.198069030 -0.073079854 -0.120827065 -0.234453126 -0.146170942
## [136]  0.009037591 -0.036311793  0.080651069  0.001147537  0.188539605
## [141] -0.125346848 -0.048922396 -0.042202502 -0.033700267  0.022153061
## [146] -0.183936553 -0.089692394 -0.127798681 -0.070009788  0.016493535
## [151]  0.148094805  0.043300044 -0.218601391  0.058369260  0.023972273
## [156]  0.095272348 -0.073958143  0.023879962 -0.245821274 -0.032424312
## [161]  0.025450456  0.079945071 -0.078680155  0.009563821 -0.021347039
## [166] -0.079672872 -0.183348757  0.146643144 -0.011521380 -0.066769583
## [171] -0.001248880 -0.271457779 -0.109410865  0.212373994  0.010784342
## [176] -0.104090487  0.030727041 -0.028721258  0.048409080  0.107108725
## [181]  0.106649317  0.071816361 -0.030224917  0.014416714 -0.018328689
## [186]  0.122428359  0.073133603 -0.009197873  0.078544609  0.035369617
## [191] -0.100225406 -0.236639016  0.060098458 -0.072704542 -0.237076723
## [196] -0.087998200  0.072095631  0.073694277  0.119391148  0.220292754</code></pre>
<p>To summarize the above, the empirical mean estimate is calculated
quickly, but not robustly; The rest of the estimators have a certain
degree of robustness, but some of them have poor estimation effect and
some of them are computationally complex.
<em>projected_gradient_descent</em> is a function via weighted mean
estimation that used by gradient descent algorithm. This function not
only ensures the robustness and accuracy of the estimation, but also
achieves good computational complexity. For more information, please
refer to the previously mentioned paper.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">library</span>(SA24204187)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>random_matrix_normal <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">200</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>outliers <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2000</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">200</span>, <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(random_matrix_normal,outliers)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># 调用投影梯度下降算法</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">projected_gradient_descent</span>(X, epsilon)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co"># 计算加权均值</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>mu_w <span class="ot">&lt;-</span> X <span class="sc">%*%</span> w</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;加权均值:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;加权均值:&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">print</span>(mu_w)</span></code></pre></div>
<pre><code>##                 [,1]
##   [1,] -0.0803931532
##   [2,] -0.0705949675
##   [3,]  0.0081181634
##   [4,] -0.0209727144
##   [5,]  0.1427480381
##   [6,]  0.0683880312
##   [7,] -0.1956956196
##   [8,] -0.0736225770
##   [9,]  0.0666972499
##  [10,] -0.0208739727
##  [11,] -0.1452001933
##  [12,]  0.0088907920
##  [13,] -0.1155502619
##  [14,]  0.0772045004
##  [15,]  0.0200256248
##  [16,] -0.2545215199
##  [17,]  0.0936539765
##  [18,] -0.1433369380
##  [19,]  0.0019381445
##  [20,] -0.0948636203
##  [21,]  0.1767536580
##  [22,]  0.1472724230
##  [23,]  0.0849361938
##  [24,]  0.0674572364
##  [25,] -0.0248781379
##  [26,]  0.1257367345
##  [27,]  0.1421429129
##  [28,]  0.0646205701
##  [29,] -0.0677991563
##  [30,] -0.0505935503
##  [31,]  0.1097239356
##  [32,]  0.0587501456
##  [33,]  0.0505858537
##  [34,]  0.0020149846
##  [35,] -0.0500220014
##  [36,] -0.1824495743
##  [37,]  0.0983466594
##  [38,]  0.1314262875
##  [39,]  0.0835496729
##  [40,] -0.0800130043
##  [41,]  0.0786599728
##  [42,]  0.0199558456
##  [43,] -0.0609149967
##  [44,]  0.0528836242
##  [45,] -0.0172025830
##  [46,]  0.0054368984
##  [47,]  0.0919087648
##  [48,] -0.1667704315
##  [49,]  0.0098738865
##  [50,] -0.1943381119
##  [51,] -0.0794969647
##  [52,]  0.1147774101
##  [53,]  0.0636893696
##  [54,]  0.1349962610
##  [55,] -0.0033399210
##  [56,] -0.0130928916
##  [57,]  0.1793121143
##  [58,]  0.2139096311
##  [59,]  0.1148553124
##  [60,] -0.2082564682
##  [61,]  0.0827531284
##  [62,] -0.1545693448
##  [63,]  0.0230134201
##  [64,]  0.0635556263
##  [65,] -0.1595434140
##  [66,] -0.0463519544
##  [67,]  0.0078692348
##  [68,]  0.0128243100
##  [69,]  0.0392118850
##  [70,] -0.0856921324
##  [71,] -0.1757302569
##  [72,]  0.1576824664
##  [73,]  0.0463310886
##  [74,] -0.0978760142
##  [75,] -0.1614948684
##  [76,] -0.0637683152
##  [77,]  0.0172166933
##  [78,] -0.0777785987
##  [79,] -0.2598599485
##  [80,] -0.1209423704
##  [81,] -0.0243383031
##  [82,]  0.0196320972
##  [83,] -0.0516065988
##  [84,] -0.0520874719
##  [85,] -0.2203195203
##  [86,]  0.1589445338
##  [87,]  0.0859032314
##  [88,] -0.1333473452
##  [89,] -0.0667293182
##  [90,] -0.0208380260
##  [91,] -0.0255021120
##  [92,] -0.0848829518
##  [93,]  0.1628046949
##  [94,] -0.0735913631
##  [95,]  0.2065200605
##  [96,] -0.1043202627
##  [97,]  0.0095938363
##  [98,] -0.0830478484
##  [99,] -0.0391824019
## [100,] -0.0168832560
## [101,] -0.1810637964
## [102,] -0.0354156933
## [103,] -0.0591580812
## [104,] -0.0751565050
## [105,] -0.0265010338
## [106,] -0.0460145227
## [107,]  0.3811280287
## [108,]  0.0256739005
## [109,] -0.0176446359
## [110,]  0.0113557245
## [111,]  0.1577541388
## [112,]  0.1422000419
## [113,] -0.0791691158
## [114,]  0.1623309910
## [115,] -0.1463644474
## [116,] -0.0500782509
## [117,]  0.0083984773
## [118,]  0.0031928591
## [119,]  0.0098607045
## [120,] -0.0024495637
## [121,]  0.0197823192
## [122,] -0.1467457523
## [123,] -0.0765143250
## [124,]  0.0012489113
## [125,] -0.1272977878
## [126,]  0.0250534098
## [127,]  0.0724036298
## [128,] -0.2819553581
## [129,] -0.1266984836
## [130,]  0.0807822907
## [131,]  0.1403463063
## [132,] -0.1688687170
## [133,] -0.2467727461
## [134,] -0.2054611393
## [135,] -0.1099237852
## [136,] -0.0309430538
## [137,]  0.0073441320
## [138,] -0.0005795305
## [139,] -0.0096721991
## [140,]  0.1349838248
## [141,] -0.1385904188
## [142,] -0.0451817932
## [143,] -0.1183617231
## [144,]  0.0809003195
## [145,]  0.0344162460
## [146,] -0.2882664558
## [147,]  0.0010534809
## [148,] -0.0564107020
## [149,] -0.0386552022
## [150,]  0.0003229642
## [151,]  0.0619160705
## [152,]  0.0940911438
## [153,] -0.1537484820
## [154,]  0.0369113998
## [155,]  0.0497389571
## [156,]  0.1861225658
## [157,] -0.0218960355
## [158,] -0.0530741703
## [159,] -0.2027717841
## [160,]  0.0532605351
## [161,]  0.0032688752
## [162,]  0.1969150221
## [163,] -0.1181050712
## [164,]  0.1059325982
## [165,] -0.0249818445
## [166,] -0.0256960142
## [167,] -0.1813603737
## [168,]  0.2458579101
## [169,]  0.1539741554
## [170,] -0.0180969826
## [171,]  0.0435117579
## [172,] -0.2058998798
## [173,]  0.0604988634
## [174,]  0.0560813366
## [175,]  0.0463736688
## [176,]  0.0067208056
## [177,]  0.1006758244
## [178,]  0.0414363532
## [179,]  0.0868089040
## [180,]  0.2231153261
## [181,]  0.1103237470
## [182,]  0.1022534157
## [183,] -0.0391249234
## [184,]  0.1139666970
## [185,] -0.1585020394
## [186,]  0.0193552230
## [187,]  0.0734483831
## [188,] -0.0653180697
## [189,]  0.0456489393
## [190,] -0.0399723704
## [191,] -0.0591876484
## [192,] -0.2463700189
## [193,]  0.0229400652
## [194,] -0.0350163542
## [195,] -0.2773590932
## [196,] -0.1491505071
## [197,]  0.1633984039
## [198,]  0.0694319497
## [199,]  0.1995863052
## [200,]  0.2034342373</code></pre>
</div>
<div id="homework-2024-09-09" class="section level1">
<h1>Homework-2024-09-09</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="analysis-of-the-question" class="section level3">
<h3>Analysis of the question</h3>
<ul>
<li><p>Find out sufficient data from books, Internet and R
positively.</p></li>
<li><p>Using texts, tables, and figures to indicate kinds of
characteristics of these data obviously.</p></li>
<li><p>Using mathematical formulas in the text as much as
possible.</p></li>
</ul>
</div>
<div id="examples" class="section level3">
<h3>Examples</h3>
<ul>
<li>Example 1: analyse the data named iris in R.</li>
</ul>
<p>Using <code>head()</code> to obverse the data :</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">attach</span>(iris)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>Now, let’s do some little experiments:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species) <span class="co">#Check the number of flowers in different species</span></span></code></pre></div>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>xtable<span class="sc">::</span><span class="fu">xtable</span>(<span class="fu">table</span>(iris<span class="sc">$</span>Species))</span></code></pre></div>
<pre><code>## % latex table generated in R 4.4.2 by xtable 1.8-4 package
## % Sat Dec  7 17:23:26 2024
## \begin{table}[ht]
## \centering
## \begin{tabular}{rr}
##   \hline
##  &amp; V1 \\ 
##   \hline
## setosa &amp;  50 \\ 
##   versicolor &amp;  50 \\ 
##   virginica &amp;  50 \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">detach</span>(iris)</span></code></pre></div>
<ul>
<li>Example 2: analyse the data named freeny.x in R.</li>
</ul>
<p>The data are notes of four factors that affect revenue. Now, let’s do
some little experiments:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">plot</span>(freeny.x[,<span class="dv">1</span>],freeny.x[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;lag quarterly revenue&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;price index&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>LM <span class="ot">=</span> <span class="fu">lm</span>(freeny.x[,<span class="dv">1</span>]<span class="sc">~</span>freeny.x[,<span class="dv">2</span>])</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">summary</span>(LM)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = freeny.x[, 1] ~ freeny.x[, 2])
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.130648 -0.033129 -0.001922  0.037161  0.085705 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.80429    0.25382   78.03   &lt;2e-16 ***
## freeny.x[, 2] -2.34056    0.05643  -41.48   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04639 on 37 degrees of freedom
## Multiple R-squared:  0.9789, Adjusted R-squared:  0.9784 
## F-statistic:  1720 on 1 and 37 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The <span class="math inline">\(R^2\)</span> is 0.9789468.</p>
<ul>
<li>Example 3: analyse the data named swiss in R.</li>
</ul>
<p>Firstly, using <code>head()</code> to obverse the data :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">head</span>(swiss)</span></code></pre></div>
<pre><code>##              Fertility Agriculture Examination Education Catholic
## Courtelary        80.2        17.0          15        12     9.96
## Delemont          83.1        45.1           6         9    84.84
## Franches-Mnt      92.5        39.7           5         5    93.40
## Moutier           85.8        36.5          12         7    33.77
## Neuveville        76.9        43.5          17        15     5.16
## Porrentruy        76.1        35.3           9         7    90.57
##              Infant.Mortality
## Courtelary               22.2
## Delemont                 22.2
## Franches-Mnt             20.2
## Moutier                  20.3
## Neuveville               20.6
## Porrentruy               26.6</code></pre>
<p>Using <code>plot()</code> to get scatter plots:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">plot</span>(swiss)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-2024-09-14" class="section level1">
<h1>Homework-2024-09-14</h1>
<div id="question-1-exercise-3.4-in-statistical-computing-with-r" class="section level2">
<h2>Question 1 (Exercise 3.4 in “Statistical Computing with R”)</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2} e^{-x^2 /\left(2
\sigma^2\right)}, \quad x \geq 0, \sigma&gt;0.\]</span> Develop an
algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate
Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for
several choices of <span class="math inline">\(\sigma &gt; 0\)</span>
and check that the mode of the generated samples is close to the
theoretical mode <span class="math inline">\(\sigma\)</span> (check the
histogram).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="analysis" class="section level3">
<h3>Analysis</h3>
<p>Because of the continuous pdf of the distribution, we can use the
method named ” the inverse transform method” to generate random samples
from some Rayleigh(<span class="math inline">\(\sigma\)</span>)
distributions whose parameters <span class="math inline">\(\sigma\)</span> are different and graph the
relative histograms. Note that the cdf of the distribution is <span class="math display">\[F(x) = 1 - exp(-x^2/(2*\sigma^2)) ,\quad x \geq
0.\]</span> We can check the histograms in order to check that the mode
of the generated samples is close to the theoretical mode.</p>
</div>
<div id="examples-1" class="section level3">
<h3>Examples</h3>
<p>We assume that the number of random samples is <span class="math inline">\(1000\)</span>, the parameters <span class="math inline">\(\sigma\)</span> are 1, 2 and 3. Just do what the
content of the analysis needs to do.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) <span class="co"># Uniform  distribution</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># sigma &gt; 0</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u)) <span class="co"># F(x) = 1 - exp(-x^2/(2*sigma^2)) , x &gt;= 0</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x) <span class="sc">==</span> (x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>)  <span class="sc">*</span> <span class="fu">exp</span>( <span class="sc">-</span> x<span class="sc">^</span>{<span class="dv">2</span>} <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma <span class="sc">^</span> <span class="dv">2</span>)) , <span class="at">sigma =</span> <span class="dv">1</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="fu">lines</span>(y, (y <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>      <span class="sc">*</span> <span class="fu">exp</span>( <span class="sc">-</span> y<span class="sc">^</span>{<span class="dv">2</span>} <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma <span class="sc">^</span> <span class="dv">2</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The plot above is the histogram under the parameter <span class="math inline">\(\sigma\)</span> is 1. Similarly, the plots below
are the conditions on the parameters <span class="math inline">\(\sigma\)</span> are 2 and 3.</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6OgA6Ojo6OpA6ZrY6kNtmAABmADpmOgBmOjpmZmZmkLZmtttmtv+QOgCQZjqQ2/+2ZgC2Zjq22/+2/7a2///T09PbkDrbtmbb25Db2//b/9vb////tmb/25D/27b//7b//9v///82vGwKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJAklEQVR4nO2dC3ubNhiFla6Ju0vT7lIvrFvYJXZt//8fOC7GJsZwPtCRkMN5+6zbs7j49EXSJ0CAO4hB3NwBUkeCABIEkCCABAEkCCBBAAkCSBBAggASBJAggAQBJAggQQAJAkgQQIIAEgSQIIAEASQIIEEACQJIEECCABIEkCCABAEkCCBBAAkCRBL07Wfn7n56ifNlBva/F3l+teSJI2i7ciXv/4rybZjd5yrPg+GjUQTt1+63ohWt3ccY32Ygd0Vr/vb57gl/NIqg3eND61/zs1/fl70rd1/wZ2MO0skIqvnn8Z2hy/ME/f191a/dfe/Qt4naxUCevPjJV8NmaII2zgFB21W/Oz4oT/bD0L48wxK0e7wrxuFNUzmzJt65U21XljGRBc5TNiJDl2cJ2q6q7pM/9O2U3L23tGgWMM+hHKsNgxBL0KauCNvV9cJQFPqY/QvmqckiCjom2T3W4/BFk95HnwIN5tk9VntrZyljtEE6q77z2LI7P7TMOLiAPOVE0bTXaIKKvfK1mJxePZo4Hmk4Z5l4RMhT/BDMSM7w5kH7P3qPR08lN6KgoTzpHazeMBIEkCCABAEkCCBBAAkCSBBAggASBJAggAQBJAggQQAJAkgQQIIAEgSQIIAEASQIcNuC9uvgV0tuWlDeXPkLuLDmlgXt1yctebAr/7csaPd4uqC9CdbJpggaXjIRj+Ra0PGKdvSLyL2cVmGmMgYdc6TSgs67LODao3FdrF5Yk46gCIwdg7K7JwkapJh7JCZo41zA5aHjq9h29V0ygjJX7K4fX9oFn82EMl/M7xMRVC6zy6rWk0aZT42q3Ww/lILSmigW5CnMg+olrPt/D+m3oPMEkrI5K6fd1Kz2DZCH/DeK3GPzunxtegfFpQuCxBYET1AtXBA+QTWXoL6iEVeQ4fTCsluQ4QTVsgWpBSHwCarIgiIUjbHng8AJqsgTxQhF45bnQVG6/C0LilI0blmQWhAiRtG4aUExisZtC4JIEECCABJ0HZ1RtCJBAAkCSBBAggASBEhVUDKeiIKKw5rpD/G7mHcw5h9eeU5QW1Be/L18l/rxBDHz8LbgnYkp6EDLw9xC7reClSyIlMeHV1sonxT1pXnS6fTN0VZ5kPJ4cd5CefKpTuKxGqkWxBqlSXm8aFUxxkrIUwvyTkbMw9nC7lOdx28xWy3omSGIl8eLjiC/xXV8QYQ8B580xz+anad6/mWVIMgzD3Hi2mlBfvBbkB9HQR5dLcSxGEUQh4QFRTBUr23dwNUdXlXVNV91uhnMe1B0pSA/87Y8laDqonPvrQjNvOzZUxANkiAbpaCjmsFr884tWNDxzqPB1R1FHoag8utycPNeXh0cHYZXlTrOGITzmFsQR1B2/7JdPRyygdNU5cL2+uUYUND0RPY89TD1cOjeivAqD0lQuSvKJf0DU/t6PU51cB1ekCFP9anyZrr+e3rJgsqH4A9M7ZtaUezbOIJAHgNnQVPztLrYQ3nL7tDrZU4rurKHGF0M5jHAFFS11v16KE+jpfgoFuTfhGAeTJOHIchCs+at95UdREEUYgsybS6aIMOTIJiCKM/iIQoy5MHvnmEKsrzH5YRhkPYVZMkDhyiioN65lmkr7RNUHEG2PD03Y3byUAQxboZnCiLlcUdBE/Oc/phvQT1vjiOIlucoaOrE7PzH+m8dPmO5/ciRxiBLHghRkOWEmen2o5MgP0XjTuANFA1aC8LYbh4hCeIQV5Dt9qO3K6ho1Pcv2UBxjdyCYB4D1EH67ikvj54HEpluP2IJMuSxF43phb5V5j9W7WLw/Ivl9iOSIEseW9F4Pv2akuPVRLEM5L1YgFbFYB5jl3/mtqDM60k8/BY0kMdYNEiCjn3e9Abtwc1xx6ChPHFb0HGA8Vy1RK5iII+taNAEMYg8DzIVjSULMuUhCap3hu+z0tqC/C5s8PJwBB1fNpx7rm2nCfLL0z5hxhG0aQZDz8eQsgQx8zAEtc5ODV2btwU6C5psiJqHIah1xON9qZchiJqHcahBezo8TRAxjwSBPIkJchI0vLm3Kug8c0hDEDEP6XyQF62JGUUQjVQEvQqUrqApeZYlaEIgCYJboAeSIBCoJWh2Q8kLmtuQBBnySNCVGG2eW78mbIqcLA1B5zzJCXJpCxofKLSgsIbw4oULQePbUFhBgadChsULixZkufSceBcLK8iyeCGyIFOfX3ALsvX5mGMQXLwQVZBxj8UTZFi8EFWQqc8/xxQE6VaxsYHoLehS0LyTxUs9YQWZ+nxHkP/dq/0YikZH0EhF4z5t6PMxW5ClaHQEjdxh9HlQREHGLh+zBeHNXRMUypCxaMwiqPfummtjUChB01rQyDzsC4d9UL7mkt6iQcwz9wkbP5J73/wCIR+svj3IB6tzEe7d0+RDjd7h0TPmZKIO0pZlTe7y9/b/mAHX/af5T/sGrJha0OXvSxJkOFiNLAgXjbiCDPOOqIIMRSOyIOv24giydvnFCrIWjcUKUgtCGIvGcgUZi0ZSgt4cEgSQIIAEASQIIEEACQJIEECCABIEkCCABAEkCEAVtLn+xKjT60pi05NnFExB5SNbNt1EefXmixkM9eQZB1FQfYKv87SW+kkufg9xYeYZCVFQ/aifzkXg2QT15BkJU9CHsjV3T5/P1cX68oyDKKju7lc6PWOsZOYZRQRB5esNtqv4y0GSE9TTpDlDAS/PSMIP0pwdycszkvBlvs7puyN5eUYSYaI41xiU3ESxOqa4lqd8L/EsS/Z68oxCB6sACQJIEECCABIEkCCABAEkCCBBAAkCSBBAggASBJAggAQBJAggQQAJAkgQQIIAEgSQIIAEASQIIEEACQJIEECCABIEkCBAKEHlwq7WqxxnZ3KeUIKat6GnwuQ8wbrY5t2fn2ZY+9vL1DzhxqDMxV9cP8TEPOEEzXL/ygAT8wQTtF//ktTTFqfmCSYov/9vnU4Rm54nlKDy6VAzrI3uZXKeUIKyoqS23vk9O5PzaCYNkCCABAEkCCBBAAkCSBBAggASBJAggAQBJAggQQAJAkgQQIIAEgSQIIAEASQIIEEACQJIEECCAP8DaG9BRklJOlcAAAAASUVORK5CYII=" /><!-- --></p>
<p>Above all, we can observe that the mode of the generated samples is
close to the theoretical mode when the distribution is Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution.</p>
</div>
</div>
</div>
<div id="question-2-exercise-3.11-in-statistical-computing-with-r" class="section level1">
<h1>Question 2 (Exercise 3.11 in “Statistical Computing with R”)</h1>
<p>Generate a random sample of size <span class="math inline">\(1000\)</span> from a normal location mixture. The
components of the mixture have <span class="math inline">\(\mathcal{N}(0, 1)\)</span> and <span class="math inline">\(\mathcal{N}(3, 1)\)</span> distributions with
mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span>. Graph the histogram of the
sample with density superimposed, for <span class="math inline">\(p_1 =
0.75\)</span>. Repeat with different values for p1 and observe whether
the empirical distribution of the mixture appears to be bimodal. Make a
conjecture about the values of <span class="math inline">\(p_1\)</span>
that produce bimodal mixtures.</p>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="analysis-1" class="section level3">
<h3>Analysis</h3>
<p>Compare the methods for simulation of a convolution and a mixture of
normal variables. The notation <span class="math inline">\(S = X_1 +
X_2\)</span> denotes the convolution of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. The distribution of <span class="math inline">\(S\)</span> is normal with mean <span class="math inline">\(\mu_1 + \mu_2 = 3\)</span> and variance <span class="math inline">\(\sigma_1^2+\sigma_2^2=2.\)</span> Unlike the
convolution above, the distribution of the mixture <span class="math inline">\(X\)</span> is distinctly non-normal; it is
bimodal.</p>
<p>To simulate the mixture:</p>
<ol style="list-style-type: decimal">
<li><p>Generate an integer <span class="math inline">\(k \in \{0,
1\}\)</span> where <span class="math inline">\(P(0) = p_0 ,P(1) =
1-P(0).\)</span></p></li>
<li><p>If <span class="math inline">\(k = 0\)</span> deliver random x
from <span class="math inline">\(X_1 \sim \mathcal{N}(0, 1)\)</span>; if
<span class="math inline">\(k = 1\)</span> deliver random x from <span class="math inline">\(X_2 \sim \mathcal{N}(3, 1)\)</span>.</p></li>
</ol>
</div>
<div id="examples-2" class="section level3">
<h3>Examples</h3>
<p>Now, graph the histogram of the sample with density superimposed, for
<span class="math inline">\(p_1 = 0.75\)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span> <span class="co"># 0.50时有明显双峰</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> p1</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>choice <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p1)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>Z <span class="ot">&lt;-</span> choice <span class="sc">*</span> X1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>choice) <span class="sc">*</span> X2</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="fu">hist</span>(X1);<span class="fu">hist</span>(Z);<span class="fu">hist</span>(X2)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>Since <span class="math inline">\(X_1 \sim \mathcal{N}(0, 1)\)</span>
might make the existence of <span class="math inline">\(X_2 \sim
\mathcal{N}(3, 1)\)</span> more obscure when <span class="math inline">\(p_1 &gt;&gt; p_2\)</span>, and similar
circumstance might happen when <span class="math inline">\(p_1 &lt;&lt;
p_2\)</span>. So, when <span class="math inline">\(p_1 \approx
p_2\)</span>, such as <span class="math inline">\(p_1 = p_2 =
0.5\)</span>, the histogram should be bimodal.</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQ2/+2ZgC2Zjq22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDbtrbb25Db27bb/9vb////tmb/25D/27b//7b//9v////UlTpzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALBElEQVR4nO2dAXfjthGEYaeO3MZNrMRtmvbsS65WLvWpbZqaOor//4eFFCXZFokdLLhrkfLMu5zuOeIs9GGBJQmYChUlKhy7AWMXAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQERENAzQOV8VlXru/OH5r+hvv++DNf1S3HQAR4xPL2LAAD994c8/3J+8bj5x+Lw5w4xPL0XfYCefrS6nA0MUB7+3CGGp3cZy6D1hxC+Wd+FcP7wuf7n1ccmWvjzzflDOf/iq/OH1U0If7ivf/blh3D2j5twdtuatG9uDjy77w3sF8PH+wWg0KgNsAy39Z+mB8r5+cfPd43xxWMRmtf60Loxj80PVpfnH1eXZ+/Km7bjnr+5v2f8Yvh4xzJoGb5497hJ0aKZreq/mtf107G//vOrOlrbgovHXWbv3hwH5BfDxzsGqNykYHN83RGbY5rXfYDy5uyH3+bdALs37wOsBUBWMVzbH69iv30Is2gPFLVRm6KgBwoBkFUM1/ZHh9hZjf+6+dHzYfmfsA/QdE23Bw7HcDmXhphNDN/2S1Xs68fq51AfsK0CxWX4+mZ37M91Bn84uz8MsK0C+zK5kE4UjWL4tl93qWFxjnrMGBne6YDqivjweZ554jWCGJneigyqL0/ClXMCecbI8+bVPBABAREQEAEBERAQAQEREBABAREQEAEBHRdQsblJ2nv3eiw6KqD13eZW+eqq9/bsOHRUQOV3D89exqlRZNCfvAAZDOHjzkGrS9c5yGIIn3QVsxjCJ13FLIbwKOYgtypmMITHVcVCqyM2qaNRZNDBELBr04lWMbM2+Vex41wKmAGyGMLim19jEp11y7B5Bg0ZwuKb5fOI4bNp8wGK84deQCZTtTyEk0IkZVD/eUT4NPQzbMiU3/3iBqhfdoDk84jhgNbvG+fyL31DwCqDhCFsAEg+dDCg+gM0KVqcOwGShnBqiAFVzABQv8wASUM4NcSAKjZ+QNIQTg2hq2IvziPGD0gawqkhcqrYdAAJ/qkhcqoYAaUdQ0DgPMIbkBsi2zkofh7hDcjL3rqKRc8jCAicRxAQOI8gIHAMAYFjCAgcQ0DgmBMAlIDobQNKCDFuQD5n06cEyCUEAaX4V68CyIcQAaX4ExDwJyDgT0DAn4Aa9a+7EdBOkXU3AtopsnvEDpCQodUUAEnrbhaApAytpgBIWnezACRlaDUJQIK/ZQZF1+bHDqjp2mUIh89ispuD0A6zCQAqZpOuYlIVCCaAlteR3SNWc1AsQysLQGIVsAA0v/jf3+uXvzplkJShlQUgsQoYAGomibP71R8dq1g0QyvLDOqtAiaA4m0yASRkaGUyB0lV4JUADYsRz9DKBJB0zCsBcqhjzwFBdzgHRauAySQdtg/P7PpPBVC8ClhkUPlt3w7jSQGKVwGTIVb0PdF0DygMBCRlaGUCSKoCrzAHfRqaQUKGbjp7KCCxCkwBkJChmwo5HJBwzCQAxf0JCPgTEPA3ASRWAQKqUBUgILkKEBAI8JYAlfNr8L6eAApAGf4qQFnt12VQfU2aHCMng9T+ygzKaL96iNUxbjUBtDdrdP76IaZtvw5Q0fRA4pOIcgCp/ZWAMtqvm4M0jzLXA8rwV85BGe1/lSrmUsZGWMWa853ORTsKoAGk99cBymm/BtDmF8OSH/KiB5ThrwKU1X7VHNT+amHis9Ay5iC9v24Oymm/KoOaBbDeywohgCaD9P66DMppv2oOaq7bk7+0JGMO0vvr5qCc9rOKif5KQMue2z4ogAaQ3l8HKKf9qkm6974PCKCZpPX+ukk6p/3qKqYNoK1iOn99FdP5K4fYIu0y70UAzRCL+ION5OlDLKf9umsx3zko4o82kiuuxfrbL+6Qm0AVQxvJh1YxeYec9jzo3XvHa7F+f7SRXHUe1OMv75BTnkkvbj2vxSL+YCO55ky6z1/eIaesYovbnlIAd7mmV7Fef6FN2irW6y/ukFNnUPdaBu9y1WRQz7WSVRWL+fdr7z/4Wgzvch12LWZWxWLXYqADBlcxvMvVuIodbCT3rGI6QLHzCLjL1eY8aHAVi/ijDkj5BM/+f5G6sJSZQT3+VlUs4o86QAnIsYrF/IU26QHpqlgGoO5jo82qWMRfapMekN4/HVA7hjspKj7LVT8HqYZwxhyk9ldmUFfuVQxsJPe8o5iTQd06YFvFuv5gI7kygzr+qAMUGdTsFy9Sl28zMijmL28kV9xy7fcHHaDIoOx1sTRCR1sXAzv5kwFlrVspAI1wXUw5xJrR2vWXx7ACUMRfapP+WkzvP7iKyWNYA0ilEVax6B1FaQwrM0h5x9LijiLyV81B2juK2jlI7z/8jiLyV1Ux/R0/XRU7yh1F4K/MIN8qlnPH7zXuKCqqmHb3hbaKjWt3R8aJYrKyhpje33fpmYAS/BVDTL+2rRtiOf47QCkh8vy1V/PK/TuaDMrxVwDK9B9+Ji0GeK0zafMQpwAohDEB0n5ZtBZQhn/b+kRAme3XAVoqZrkcQEp/NaCM9hOQ4E9AwF8JKHJLHQRIB6T31wHKa/+0q5gGUIY/AQF/AgL+BAT8CQj4ExDwJyDgPxVA0Q1aRoASNnGOGlB8g5YNoJRNnMMAiT0wHFB8m7ENIPS7IIMByT1gl0HdDVq2GWS0ibMruQcM5qDoBi2jOch2E2dXcg84VLH2otOviu39reYgsQds5qD+h+nazUHSlwrYV7EXPWACKPIwXTNAsYf1BrM5KN4DJoBePkx3728GKOJvB0j4WgcDQNGH6RoBij+s1wxQrAeMJunYw3StJunow3qfAAF/GZDYA5O+FnsCBBb/QXSpBwgIBCAgEICAQAACAgEICAQgIBCAgEAAAgIBtueh9ohOC5DPL5sQEPAnIOBPQMCfgID/1AG15YuAosfs2BBQ5BgCAscQEDiGgMAxBASOISBwzAtAHh/AGdDuLOUT/gBvFNCnaQPatZ6AIv4tFwKK+h8Aso5wcoCsCyUBIX8CAv7ugMKJAZL83ySgQEDA3wxQZKf9AaB8RDF/K0Bi+w0AxXbaWwGK+hsBkttvACj2sNuOMj/AFPyTMij1OcRaTcFf7pz+nfZ2moC//e2uExMBAREQUBYgoyKTHsHX3fxMenNP9OVf1grbW+tP/zR3D9X+DwH1uRMQcCcg4E5AwJ2AgLsnoLckAgIiICACAiIgIAICIiAgAgIiIKAsQIsQNM+Q12t9F0Lqt52pVRy0finGygFUzNTPuFZqOdutSNir/Pb+xTLH6upRipU5xJwBNVqmfqejUg2Q59+TBOLkAVo6D7HKsQua59k8/5aJxd8urYfYxtaZUP83m1moA+jiUfo0WkCL7YzmNQC2EToPVLHT4RBr4AifJnOSds4gt8XoqjtJg0+TW+bdEmgXwC9ET5kXQvFEEYiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAgoc1Wj+R6Axcxz+af9XTin1cNt+1PWJzMzaHG9uZdbzlO/mTJLfrfu2/anrE9mLxz+68eHav3jL54LiOXcbWWgbX8jtDyTOwcV7Y1vzxXW9Z3jysC2/fgD5AJafj9L8h+ghdv2heqp/XB9MhPQ6ur/m8HrCGh5+IUwltq2P2GSywPULE1uVt8cq5jn9L9tf8r6ZBagdnZoutgNUFOB3cr8rv0/JaxP8kQRiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIB+B0lUISSET0v0AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
</div>
<div id="question-3-exercise-3.20-in-statistical-computing-with-r" class="section level2">
<h2>Question 3 (Exercise 3.20 in “Statistical Computing with R”)</h2>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t \geq 0\}\)</span> that can be
represented as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)} Y_i, t \geq 0,\)</span>
where <span class="math inline">\(\{N(t), t \geq 0\}\)</span> is a
Poisson process and <span class="math inline">\(Y_1, Y_2,
\ldots\)</span> are i.i.d. and independent of <span class="math inline">\(\{N(t), t \geq 0\}.\)</span> Write a program to
simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)–Gamma process (<span class="math inline">\(Y\)</span> has a <span class="math inline">\(\Gamma\)</span> distribution). Estimate the mean
and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda t
E\left[Y_1\right]\)</span> and <span class="math inline">\(\operatorname{Var}(X(t))=\lambda t
E\left[Y_1^2\right].\)</span></p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="analysis-2" class="section level3">
<h3>Analysis</h3>
<p>A homogeneous Poisson process <span class="math inline">\(\{N(t), t ≥
0\}\)</span> with rate <span class="math inline">\(\lambda\)</span> is a
counting process, with independent increments, such that <span class="math inline">\(N(0) = 0\)</span> and <span class="math display">\[ P(N(s+t)-N(s)=n)=\frac{e^{\lambda t}(\lambda
t)^n}{n!}, \quad n \geq 0,\quad t, s&gt;0. \]</span>Thus, a homogeneous
Poisson process has stationary increments and the number of events <span class="math inline">\(N(t)\)</span> in <span class="math inline">\([0,
t]\)</span> has the Poisson(<span class="math inline">\(\lambda
t\)</span>) distribution. In the same time, <span class="math inline">\(Y_1 \sim \Gamma(r,\beta)\)</span>. Note that the
mean of <span class="math inline">\(Y_1 \sim \Gamma(r,\beta)\)</span> is
<span class="math inline">\(r / \beta\)</span>, the variance of <span class="math inline">\(Y_1 \sim \Gamma(r,\beta)\)</span> is <span class="math inline">\(r / \beta^2\)</span>.</p>
</div>
<div id="examples-3" class="section level3">
<h3>Examples</h3>
<p>We assume that the number of random samples is <span class="math inline">\(1000\)</span>, time is <span class="math inline">\(t = 10\)</span>. the parameters <span class="math inline">\(\lambda = 1, r = 1, \beta = 1\)</span>. Computing
the mean and variance of the random samples, and compare the values with
the relatively theoretical values.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>Nt <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda <span class="sc">*</span> t)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(Nt[i], r, beta)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  X[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>} <span class="co"># Now, X is the vector whose elements are the samples we need to use</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>tmean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (r <span class="sc">/</span> beta)</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>tvariance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> ((r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>r <span class="sc">/</span> beta)</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="fu">mean</span>(X); tmean <span class="co"># tmean is the theoretical mean</span></span></code></pre></div>
<pre><code>## [1] 9.968391</code></pre>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">var</span>(X); tvariance <span class="co"># tvariance is the theoretical variance</span></span></code></pre></div>
<pre><code>## [1] 19.59968</code></pre>
<pre><code>## [1] 20</code></pre>
<p>The relative values of the random samples are close to the
theoretical vales. # Homework-2024-09-23</p>
</div>
</div>
<div id="question-1-exercise-5.4-in-statistical-computing-with-r" class="section level2">
<h2>Question 1 (Exercise 5.4 in “Statistical Computing with R”)</h2>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to
estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2,\ldots, 0.9\)</span>. Compare the
estimates with the values returned by the “pbeta” function in R.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="analysis-3" class="section level3">
<h3>Analysis</h3>
<p>Generally, we can know the Beta function is a function whose formula
is <span class="math display">\[B(\alpha, \beta) = \int^1_0 x^{\alpha -
1}(1-x)^{\beta-1} dx,\]</span> There are additional formula for Beta
function, that is <span class="math display">\[B(\alpha, \beta) =
\frac{\Gamma(\alpha) \times
\Gamma(\beta)}{\Gamma(\alpha+\beta)}.\]</span> Under these formula, one
could find out the p.d.f. of Beta distribution, that is <span class="math display">\[f(x;\alpha,\beta) =
\frac{1}{Beta(3,3)}x^{\alpha-1}(1-x)^{\beta-1}.\]</span> Because there
is no explicit formula for the c.d.f. of Beta distribution without
integral mode, one needs to use the Monte Carlo Method to compute the
values in R.</p>
</div>
<div id="examples-4" class="section level3">
<h3>Examples</h3>
<p>We assume that the number of random samples is <span class="math inline">\(1000\)</span>, the parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are equal to 3, use the function to
estimate F(x) for x = 0.1, 0.2,…, 0.9.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>X <span class="ot">=</span> <span class="fl">0.1</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>eY <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">/</span>B) <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>}</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,X[i])</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>  g <span class="ot">&lt;-</span> X[i] <span class="sc">*</span> <span class="fu">f</span>(u)</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>  eY[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g) <span class="co">#蒙特卡洛方法计算对应值</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>}</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>tY <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(X,<span class="dv">3</span>,<span class="dv">3</span>) <span class="co">#理论Beta分布函数对应值</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="fu">plot</span>(X,tY,<span class="at">type =</span> <span class="st">&quot;o&quot;</span>,<span class="at">main =</span> <span class="st">&quot;理论值&quot;</span>)</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a><span class="fu">plot</span>(X,eY,<span class="at">type =</span> <span class="st">&quot;o&quot;</span>,<span class="at">main =</span> <span class="st">&quot;蒙特卡洛计算值&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>The picture of the experiments of the Monte Carlo Method is close to
the picture of the theoretical case.</p>
</div>
</div>
<div id="question-2-exercise-5.9-in-statistical-computing-with-r" class="section level2">
<h2>Question 2 (Exercise 5.9 in “Statistical Computing with R”)</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2} e^{-x^2 /\left(2
\sigma^2\right)}, \quad x \geq 0, \sigma&gt;0.\]</span> Implement a
function to generate samples from a Rayleigh(σ) distribution, using
antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{\prime}}{2}\)</span> compared with
<span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent
<span class="math inline">\(X_1,X_2\)</span>?</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="analysis-4" class="section level3">
<h3>Analysis</h3>
<p>Because of the continuous p.d.f. of the distribution, we can use the
method named ” the inverse transform method” to generate random samples
from some Rayleigh(<span class="math inline">\(\sigma\)</span>)
distributions whose parameters <span class="math inline">\(\sigma\)</span> are different and graph the
relative histograms. Note that the c.d.f. of the distribution is <span class="math display">\[F(x) = 1 - exp(-x^2/(2*\sigma^2)) ,\quad x \geq
0.\]</span> If <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span> and negatively correlated, <span class="math inline">\(\frac{U_1 + U_2}{2}\)</span> is also unbiased for
<span class="math inline">\(\theta\)</span> but its variance is <span class="math display">\[
\begin{aligned}
\operatorname{var}\left\{\left(U_1+U_2\right) / 2\right\} &amp;
=\left\{\operatorname{var}\left(U_1\right)+\operatorname{var}\left(U_2\right)+2
\operatorname{cov}\left(U_1, U_2\right)\right\} / 4 \\
&amp;
&lt;\left\{\operatorname{var}\left(U_1\right)+\operatorname{var}\left(U_2\right)\right\}
/ 4.
\end{aligned}
\]</span>Suppose <span class="math inline">\(var(U_1) =
var(U_2)\)</span>. If random numbers <span class="math inline">\(X_1,\ldots,X_{m/2}\quad(i.i.d.)\)</span> and <span class="math inline">\(X_{(m+1)/2},\ldots,X_{m}\quad(i.i.d.)\)</span> are
used to calculate <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span>, and <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> are negatively correlated, then the
variance of <span class="math inline">\(T_1 = (U_1 + U_2)/2\)</span> is
smaller than the one based on <span class="math inline">\(X_1, . . . ,
X_{m/2}, X_{(m+1)/2}, . . . , X_m \quad (i.i.d.)\)</span> , denoted by
<span class="math inline">\(T_2 \quad (var(T_1) = var(U_1)/2, var(T_2)
&lt; var(U_1)/2)\)</span>. The two estimates use the same number of
random numbers.</p>
</div>
<div id="examples-5" class="section level3">
<h3>Examples</h3>
<p>We assume that the number of random samples is <span class="math inline">\(1000\)</span>, and compute the sample means and
variances of the result of the experiments for <span class="math inline">\(1000\)</span> times. In the end, one should use
the final mean and variance of the sample means and variances.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>upper_value <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co">#积分上限</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#参数取值</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>Rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  g <span class="ot">&lt;-</span> ((x<span class="sc">*</span>u) <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">*</span>u)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)) <span class="co"># x*u ~ N(0,x)</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  cdf</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>} <span class="co"># 1000个取值取均值</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 1000次实验</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>Rayleigh1 <span class="ot">&lt;-</span> Rayleigh2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  Rayleigh1[i] <span class="ot">&lt;-</span> <span class="fu">Rayleigh</span>(x, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)<span class="co">#第一类，未对偶</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  Rayleigh2[i] <span class="ot">&lt;-</span> <span class="fu">Rayleigh</span>(x, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>)<span class="co">#第二类，对偶</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>}</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Rayleigh1),<span class="fu">mean</span>(Rayleigh2)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.2002 0.1999</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">sd</span>(Rayleigh1),<span class="fu">sd</span>(Rayleigh2),<span class="fu">sd</span>(Rayleigh2)<span class="sc">/</span><span class="fu">sd</span>(Rayleigh1)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.0068 0.0036 0.5282</code></pre>
<p>The output results obtained by the Monte Carlo method of the two
methods are approximately the same, and the variance of the data
obtained by the latter is smaller than that obtained by the former.</p>
</div>
</div>
<div id="question-3-exercise-5.13-in-statistical-computing-with-r" class="section level2">
<h2>Question 3 (Exercise 5.13 in “Statistical Computing with R”)</h2>
<p>Find two importance functions $f_1 $ and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math inline">\(\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 /
2} d x\)</span> by importance sampling? Explain.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="analysis-5" class="section level3">
<h3>Analysis</h3>
<p>Suppose <span class="math inline">\(X\)</span> is a random variable
with density function <span class="math inline">\(f(x)\)</span>, such
that <span class="math inline">\(f(x)&gt;0\)</span> on the set <span class="math inline">\(\{x: g(x)&gt;0\}\)</span>. Let <span class="math inline">\(Y\)</span> be the random variable <span class="math inline">\(g(X) / f(X)\)</span>. Then <span class="math display">\[
\int g(x) d x=\int \frac{g(x)}{f(x)} f(x) d x=E[Y].
\]</span> Estimate <span class="math inline">\(\mathbb{E}[Y]\)</span> by
simple Monte Carlo integration. The density <span class="math inline">\(f(x)\)</span> is called the importance
function.</p>
<p>From now on, we use the function <span class="math display">\[g(x) =
\frac{1}{x^4} \frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2 x^2}} \]</span> to
answer the relative questions because <span class="math inline">\(g(x)\)</span> is a function such that <span class="math display">\[\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2
/ 2} d x =
\int_0^1 \frac{1}{t^4} \frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2 t^2}}
dt\]</span>.</p>
</div>
<div id="examples-6" class="section level3">
<h3>Examples</h3>
<p>One can choose <span class="math inline">\(f_1(x) = e^{-x}\)</span>
and <span class="math inline">\(f_2(x) =
\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\)</span> to compute and use
function <span class="math inline">\(f_0(x) \equiv 1\)</span> to
compare.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># 调整方差的方法: importance function.</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#调整方差后的蒙特卡洛方法实验次数</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>MC_times <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#每次实验的样本量</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>cdf0 <span class="ot">&lt;-</span> cdf1 <span class="ot">&lt;-</span> cdf2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(MC_times)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>) <span class="co"># f0 = 1, f1, f2.</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;=</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>}</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)) <span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>} <span class="co"># 标准正态分布的p.d.f.</span></span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>MC_times) {</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#using f0</span></span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  cdf0[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg) </span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>}</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(cdf0) <span class="co"># f0下实验结果均值</span></span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(cdf0)<span class="co"># f0下实验结果方差</span></span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>MC_times) {</span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="co">#using f1</span></span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a>  cdf1[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a>}</span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(cdf1)<span class="co"># f1下实验结果均值</span></span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(cdf1)<span class="co"># f1下实验结果方差</span></span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>MC_times) {</span>
<span id="cb43-33"><a href="#cb43-33" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> m,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>) <span class="co">#using f2</span></span>
<span id="cb43-34"><a href="#cb43-34" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f2</span>(x)</span>
<span id="cb43-35"><a href="#cb43-35" tabindex="-1"></a>  cdf2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb43-36"><a href="#cb43-36" tabindex="-1"></a>}</span>
<span id="cb43-37"><a href="#cb43-37" tabindex="-1"></a>theta.hat[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(cdf2)<span class="co"># f1下实验结果均值</span></span>
<span id="cb43-38"><a href="#cb43-38" tabindex="-1"></a>se[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(cdf2)<span class="co"># f2下实验结果方差</span></span>
<span id="cb43-39"><a href="#cb43-39" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" tabindex="-1"></a><span class="fu">round</span>(theta.hat,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.4010 0.4011 0.4002</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>X <span class="ot">=</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)<span class="sc">*</span>.<span class="dv">001</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">g</span>(X)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>Y0 <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(X))</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>Y1 <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>X)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>Y2 <span class="ot">=</span> <span class="fu">f2</span>(X)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="fu">plot</span>(X,Y,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.4</span>),<span class="at">main =</span> <span class="st">&quot;f(x)与g(x)的函数图像&quot;</span>,<span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="fu">lines</span>(X,Y0,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="fu">lines</span>(X,Y1,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a><span class="fu">lines</span>(X,Y2,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>,<span class="st">&quot;f(x)=1&quot;</span>,<span class="st">&quot;f(x)为参数为1指数函数&quot;</span>,</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>                  <span class="st">&quot;f(x)为标准正态分布&quot;</span>),</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">lty =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Maybe the functions <span class="math inline">\(f_1,f_2\)</span> one
chosen are not ‘close’ to <span class="math inline">\(g(x)\)</span>, the
results of the experiments are that the means are almost close, but the
variances are much larger.</p>
</div>
</div>
<div id="question-4-monte-carlo-experiment" class="section level2">
<h2>Question 4 (Monte Carlo experiment)</h2>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to randomly
permuted numbers of <span class="math inline">\(1,\ldots,
n\)</span>.</p></li>
<li><p>Calculate computation time averaged over <span class="math inline">\(100\)</span> simulations, denoted by <span class="math inline">\(a_n\)</span>.</p></li>
<li><p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</p></li>
</ol>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="analysis-6" class="section level3">
<h3>Analysis</h3>
<p>The quicksort method is an efficient sorting algorithm that results
in a completely ordered sequence by continuously splitting a sequence
into two subsequences and sorting each subsequence. The time complexity
of quicksort is <span class="math inline">\(O(nlogn)\)</span> in the
average case and <span class="math inline">\(O(n^2 )\)</span> in the
worst case, but the latter rarely happens and can be avoided with a few
tricks.</p>
<p>The basic steps for quicksort are as follows:</p>
<ol style="list-style-type: decimal">
<li>Select an element from the sequence as the pivot, which can be the
first element, a random element, a median, etc.</li>
<li>Define two pointers, i and j, pointing to the beginning and end of
the sequence.</li>
<li>Move j from right to left, find the first element less than or equal
to the pivot, swap it with the element to which i refers, and then move
i one place to the right.</li>
<li>Move i from left to right, find the first element greater than or
equal to the pivot, swap it with the element that j refers to, and then
move j one place to the left.</li>
<li>Repeat steps 3 and 4 until i and j meet.</li>
<li>Return the position of i, which serves as the final position of the
pivot.</li>
</ol>
</div>
<div id="examples-7" class="section level3">
<h3>Examples</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span> <span class="co"># 总共可对n*1e4数目的数据排序</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}<span class="co">#??????</span></span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>} <span class="co"># 快速排序法</span></span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>An <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>Tn <span class="ot">=</span> An</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>    test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">*</span><span class="fl">1e4</span>), <span class="at">size =</span> i<span class="sc">*</span><span class="fl">1e4</span>)</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>    An[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>] <span class="co"># 快速排序法所需时间</span></span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>    Tn[i] <span class="ot">&lt;-</span> (i<span class="sc">*</span><span class="fl">1e4</span>)<span class="sc">*</span><span class="fu">log</span>((i<span class="sc">*</span><span class="fl">1e4</span>)) <span class="co"># nlogn</span></span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>}</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>regression_result <span class="ot">&lt;-</span> <span class="fu">lm</span>(An<span class="sc">~</span>Tn)</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a><span class="fu">summary</span>(regression_result)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = An ~ Tn)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.02869 -0.01834 -0.00229  0.01180  0.03995 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 8.928e-04  9.870e-03    0.09    0.929    
## Tn          1.012e-07  6.923e-09   14.61    2e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.02222 on 18 degrees of freedom
## Multiple R-squared:  0.9222, Adjusted R-squared:  0.9179 
## F-statistic: 213.5 on 1 and 18 DF,  p-value: 1.999e-11</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">plot</span>(Tn,An,<span class="at">main =</span> <span class="st">&quot;scatter plot and regression line&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;nlog(n)&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;computation time&quot;</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>En <span class="ot">&lt;-</span> regression_result<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> regression_result<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> Tn</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="fu">lines</span>(Tn,En) <span class="co"># 回归线</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tma227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v////A6AkzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMYElEQVR4nO2dDX/kphGHsbPXdXq95rrbS5rG7qW91ro2bR2rSWr5Rd//Y4UXAYNedgCBhNbz/+U2OgkY9BwMCM2yrCWdFFu7AqWLACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQokhAL/+8N58eqW/Ym4exAnBV7NIvoa9G6jKWwiSLA/T0QVRbfUZVyjvrRgGpantXflgp76zJAeFyazsO6H9vGbv46k4e/8SPv/hOHP38gTH27lbUmuvyG/l537585onfiyJrdvG3D+xS5eO39p+vGdvdWZM/879/8acHXUB356ZYkf8fvLDdrazn5yu2+2QBmcKtPXm4u5Vpxi6D2zCHg7q4VlunBfFLo4BqxswdVOr40LaNOrq4dQE9H+Xp3b3O1+HvMor0XaW6YvkhBGSL1QnkMc8DatHawoE9lebirQI0uAxuwx4O6uJYHQBiY4C4jf1D+5Om8oeHpyMvmmf5zUP7eCXOwi5WiX82dZqX9+au/X+rAfELvJR9VymeRtk8wJ4Di61lg6u14f2DaA0AkCwc2FNpKtYB6l0GtwEOh3WBVv0A8dy7/7b6NuU/wFfq77/88FbcMATEbR9k9VUlr00plfpLpdjKZtM1Sf4/17XoYlV+bt6YeD5CQNfqX8/Yg2mGl8FtgMNhXaBVP0Cq5coOCh3Wy0fVFF1AvGDTQmvTTA1aec4ZF2rVSQ0gUKzKL/65heE9KEXna6E9XaL2QcPL4DacO3LqAqwOAY37oKcPysbfTT07bLu//nLsAepcyCQgfv1aWtM1ECfcLmaKBVXVqQeAgD0nzfAyuA33jnp1iQDEC/z+rXRhoAWpbv/cB8RPm24V04JgsW4Lsq2j14K0vYkWZHu5uY3+Hc1tQSrdX2w3b959UrSHTtoWPADk5YNgsbCqIz5IFg7tuT5ocBnchj0c80GhgOTIJVolT8KP34vU7Fo6/qcb4CzUZ8Uuvmv5OKfKcwBNj2I25bBYVVU4Qjn0gT13FOtfBrcBDqfqEtSCPoOJQaVdqJmYqNrzSqnPbuJhiVlA03OPxkxwYLFOVUF+BxCw586DBpfBbdjDsXlQeBcTs2f2Dsykv23VcLP7VOvJ8+5OfbZPH/nIIeerfR/040d1wZm9fisrobK2brFOVV/+dcVn8AMf1AJ7spjf30Ef5FwGt2EOh3WJ9UFztdxTVIU9fs7RpgHxXvgeTvFyaNOA9KQHdOzk2jSg9unrK7vskEe05IqIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAOhZxIxUh/XqUqQsoObithbBaUTIkQH0cnNoaxHxsXhke9kygJ6P1xJQMwsQ24yCAekWVM2KtSnW5/eRhAPqfFANg0Qj6jEnc0axtle3CEAqum9mqE2hgBj4bAfHHlkT16Q4ESBESQB18bPz4sIKBZTCB73cpAgVLRVQglFMzIPmmA+cXqytuHnQgnbX09AfeSQXevwyQTBt8YB0G48BdHXGTrqTdQExXSxFuHrRgKCHXNhJh9tdSGDY6I66M+SkpcD0h7lnyEkL2QHL9c0srouxs3PSQxwzAKWsUilyvA48Q4A6wd4FzrQESGv49BM3ij0fD+fog9rpClELkpp+eI4Yxf6oRvmZbzVm5E2uU2sL8YDmvRcrCdDJuoQCquyKzqwJdTmAkKWp+BY0T6UAQpfuXrmTZuhU8FUD0s/tJ9N4FzazMl0pBa1J8zqUByhXcREVsM8RBGjaPv60FQFIb+Sz4XkQXD5MP4pVKSKn1gQU5ABjFsy2u+Qq2kvg+JBl0V4xbE51w1UAscDW0+UJTOjx2kcCElFo0zTXAMTClghNptCEDRpbJgB1aOqJSIdVADF80BpmCk7osWAmAD1eSUBTiyI5AGEjEpj1+M9Us8yD1mlBWPNgNkVAS8oESLSwfXtiyEsPCJkVq+4F15n9qhADSEYvIEGcnBFP0UwuGi0NaPDGIiOgptuIubAw4JG7tp6GYUmRYkMS6nfzU94lsLh0GjgW63L61rL6ID21KW/Rng1f/UnXPGIr5yhWbAsaNzF35SmLDzJTpenZUkpAE82BTV8KKTwiIT6Kvdxg/S8hoEmHwlo2306mBTP0gS0doOkhKcnKbq4VxYkHtgxr0lOAEpnY8pIrm1pXZowNT8QaCUtYUnQH6/2BF8ZjfWKtpE24VHG25QznP+6yT8jEecJMSMKw6I6pEIeUgPoX+ss+KwFaO7oDcc5rASooumPUs+iX7Sv6oHKiO4Zjkxskfyqlv5HkCaXQl4tZnsWyPAGHJ/T4Smat+9/kilmO5Y51oduE1ZuHeq8X5UcFvs6x2Jp0rniRmPWgQ9uIvTumlzvA27Cl3mpkWz6JWzB7/O29/DOhxVtQxnCjuAUzMZKdAGQXi5bxQTlX3yJ8kJghVofTK4rakU+mSbkelHV1MmaYr/bwB+Ey20ULyrx4u92H1bTlzDcQ+bA62+7pUrLz2fDDaqpCUtko8GF1CT5LP6ymW5NeKtJ6o056uUD0mJn06mvSS8bpR7egeYPYLEAL4pnTxapZW3jE3+TCX/OIB7TOPEgGOi+JKB7QKvOgsRXnvIoG9HxcvovZr78tRyh+FJu31VvMHTKbsWRAC9u1OSAaAjRIbzJswAfJTjZzM8XAW4TJix/FGhlcVs/b7TboHtf8hmvMmrRab15sP2mzKdQqnIpfMHNiwVcgFN+CFgkD7u9nuDyhGB8k3+ks8VWE4X6GWwDkEQQdaZf1gjMc37MdQNnsMvcP3LAP/llY5QDSTUS3ot7p7Yxis3YkP7Em3QPUP72WYkaxPDuSQ0Bs/dHLtR+SMNtmt9bROGHgK/keaD4sYb7NbvU3Svtxz6vupRPhg/JudlvCzkJQMYA8diSPDuKEfasIVjFdDF9rjQ3i7E+dCyCUxUnHhuCxwfH6hLI46bggzvGv5K6tLE7atwVBLzMIjg+rXjbNeFg9GUjuE8QJvMzEzHp9PrmexXyCOOFT1miSjY5iyeyaZ4sSOEwqBpDP5iYexfUe2wtV1IoivrmJ10SRlY9nzjB/ak3ac6JYhpc5rfiJ4om3GqETxZJBZWlBgRPFQgb0cWXxQWEtqJQp4bjyjGKTE8WxJdfzA+ShkG/7vEpAQcWdmw+SYQvT+9tF2D2vUawL6/CMUcy3NcVCyjIP8iluMwoGZOZBmcNf0BTzE6QoYiSpGsMfrzJ/HWq7gHye5hNsTbFhQLhSbE1xzoCSbCxwzoCSbE1xzoCoBWFKsTXFWQNKsTXFeQN6hSJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAIUoJqPEOUOu2+zQZgg58JBfPxZKM/U20SBsJAYkv3jde9/B8lAuSJkPQgY9ebnjKWnAxwc2xNtIBUuuNPvszNeq1iMkQdOAltemzeMWn14ajbaQDZCuFqGEHWW2TIeggoEaiMdT7Xu1CbSQEJBuz35trBUhnCDoIqJH4cebqd8oZRdtIB0h1Xj83ISthMgQdBFSIiR/1FKvD1SHMGCzlfAE1zDgTbq4AQIV1MfjihTuXArpYiBvN76Rr+GKK33kBTjpkIG4yD/PmDZ66Z26ugGE+ZCrXZJ4o2iAeebvcSRcwURT/bL4PA10/NxmCDvxqwrpYHrER9PUMG/SwiogAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiEoENLFzs/5xnXbmzwqHaUOAahCX0qT4CQcvbQeQcxa0pswqCdDz8c9HEasiUTRdqLyIX7n4XgTuXN6bFHN/xCpAZQESgc0XtwJQI0HtVSxvI6J2RCiUThEY7zpHZQE6yKA5DkhFw3EKKoauEtQONoWOrVtAZQG6lh/8P3X//NME6+mL5iPF76R4qGhA/KDWgOQZAkQt6JQAoJ4Pqo0P0oBeuw+aHMU0oFc6illAzjzo8t/dN78soFc5D5qWgaOV5tfQfFQ6oG7wknuB07PYmERXU6Hy9DRfpAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIh+BUVp6qg4ncVUAAAAAElFTkSuQmCC" /><!-- --></p>
<p>The regression results and the images show a strong linear
correlation between <span class="math inline">\(a_n\)</span> and <span class="math inline">\(t_n\)</span>.</p>
</div>
</div>
</div>
<div id="homework-2024-09-30" class="section level1">
<h1>Homework-2024-09-30</h1>
<div id="note" class="section level2">
<h2>Note</h2>
<p>From this paper on, in complex simulation studies, use at least three
separate functions for:</p>
<ol style="list-style-type: decimal">
<li><p>data generation;</p></li>
<li><p>statistical inference (ready for real data analysis);</p></li>
<li><p>result reporting.</p></li>
</ol>
<p>When scoring the exercises (TA):</p>
<ol style="list-style-type: decimal">
<li><p>Check if there are at least three functions (if not, deduct 1
point).</p></li>
<li><p>Check if memory is cleared up before calling each function (if
not, deduct 1 more point).</p></li>
</ol>
</div>
<div id="question-1-exercise-6.6-in-statistical-computing-with-r" class="section level2">
<h2>Question 1 (Exercise 6.6 in “Statistical Computing with R”)</h2>
<p>Estimate the <span class="math inline">\(0.025, 0.05, 0.95\)</span>
and <span class="math inline">\(0.975\)</span> quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1}
\approx \mathcal{N}(0, 6/n)\)</span>.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="analysis-7" class="section level3">
<h3>Analysis</h3>
<p>The skewness <span class="math inline">\(\sqrt{\beta_1}\)</span> of a
random variable <span class="math inline">\(X\)</span> is defined by
<span class="math display">\[
\sqrt{\beta_1}=\frac{E\left[\left(X-\mu_X\right)\right]^3}{\sigma_X^3},
\]</span> where <span class="math inline">\(\mu_X=E[X]\)</span> and
<span class="math inline">\(\sigma_X^2=\operatorname{Var}(X)\)</span>.
The sample coefficient of skewness is denoted by <span class="math inline">\(\sqrt{b_1}\)</span>, and defined as <span class="math display">\[
\sqrt{b_1}=\frac{\frac{1}{n}
\sum_{i=1}^n\left(X_i-\bar{X}\right)^3}{\left(\frac{1}{n}
\sum_{i=1}^n\left(X_i-\bar{X}\right)^2\right)^{3 / 2}}.
\]</span> If the distribution of <span class="math inline">\(X\)</span>
is normal, then <span class="math inline">\(\sqrt{b_1}\)</span> is
asymptotically normal with mean <span class="math inline">\(0\)</span>
and variance <span class="math inline">\(6/n\)</span>.</p>
<p>Exactly, The variance of the <span class="math inline">\(q\)</span>
sample quantile is <span class="math display">\[
\operatorname{Var}\left(\hat{x}_q\right)=\frac{q(1-q)}{n
f\left(x_q\right)^2},\]</span> where <span class="math inline">\(f\)</span> is the density of the sampled
distribution.</p>
</div>
<div id="experiments" class="section level3">
<h3>Experiments</h3>
<ol style="list-style-type: decimal">
<li>data generate:</li>
</ol>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>n_skewness <span class="ot">=</span> <span class="dv">1000</span>; n_MC <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="co"># 生成数据的函数</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_skewness =</span> <span class="dv">1000</span>, <span class="at">n_MC =</span> <span class="dv">10000</span>){</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  skewness <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_skewness)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_skewness) {</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_MC)</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>    skewness[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(((e<span class="sc">-</span><span class="fu">mean</span>(e))<span class="sc">/</span><span class="fu">sd</span>(e))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  }</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  <span class="fu">return</span>(skewness)</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>}</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(n_skewness,n_MC)</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>qt <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a><span class="co">#求解分位数</span></span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>Quantiles <span class="ot">&lt;-</span> <span class="cf">function</span>(unknown_data, qt){</span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  <span class="fu">quantile</span>(unknown_data,qt)</span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>}</span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>query_x <span class="ot">&lt;-</span> <span class="fu">Quantiles</span>(e,qt)</span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a><span class="fu">round</span>(query_x,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##    2.5%      5%     95%   97.5% 
## -0.0501 -0.0405  0.0410  0.0484</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Compute the standard error of the estimates: (Note: use the kernel
density estimation method with “Guassian’s distribution”)</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>SEE <span class="ot">&lt;-</span> <span class="cf">function</span>(unknown_data,query_x,n_skewness){</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>  <span class="co"># 使用核密度估计估计密度函数</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  density_est <span class="ot">&lt;-</span> <span class="fu">density</span>(unknown_data)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  <span class="co"># 在密度估计的自变量值x中查找最接近的值</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  L <span class="ot">&lt;-</span> <span class="fu">length</span>(query_x)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  nearest_index <span class="ot">&lt;-</span> <span class="fu">numeric</span>(L)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L) {</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>    nearest_index[i] <span class="ot">&lt;-</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(density_est<span class="sc">$</span>x <span class="sc">-</span> query_x[i]))</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>  }</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  <span class="co"># 获取对应自变量值的密度值</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>  corresponding_density <span class="ot">&lt;-</span> density_est<span class="sc">$</span>y[nearest_index]</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>  <span class="co"># 输出估计值的标准差</span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>  SEE_result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(L)</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L) {</span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>    VAR_q <span class="ot">&lt;-</span> qt[j]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>qt[j]) <span class="sc">/</span> (n_skewness <span class="sc">*</span> corresponding_density[j]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>    SEE_result[j] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(VAR_q)</span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a>  }</span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>  <span class="fu">return</span>(SEE_result)</span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>}</span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a>SEE_result <span class="ot">&lt;-</span> <span class="fu">SEE</span>(e,query_x,n_skewness)</span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a><span class="fu">round</span>(SEE_result,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.0021 0.0015 0.0015 0.0019</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Compare the estimated quantiles with the quantiles of the large
sample approximation by a simple table:</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">library</span>(xtable)<span class="co">#引用xtable包</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>Comparation <span class="ot">&lt;-</span> <span class="cf">function</span>(query_x , qt, n_MC){</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  <span class="co"># 渐进分布的分位数</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_MC,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n_MC))</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  a_query_x <span class="ot">&lt;-</span> <span class="fu">quantile</span>(a,qt)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  Table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(query_x,a_query_x)</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  Table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Table)</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  <span class="fu">colnames</span>(Table) <span class="ot">&lt;-</span> qt</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>  <span class="fu">row.names</span>(Table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;estimated quantiles&quot;</span>,</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>                        <span class="st">&quot;the quantiles of the large sample approximation&quot;</span>)</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  <span class="fu">xtable</span>(Table,<span class="at">digits =</span> <span class="dv">4</span>,<span class="at">caption =</span> <span class="st">&quot;Quantiles&quot;</span>)</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>}</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a><span class="fu">Comparation</span>(query_x, qt, n_MC) <span class="co">#表格的latex代码</span></span></code></pre></div>
<p>Table example:</p>
</div>
</div>
<div id="question-2-exercise-6.b-in-statistical-computing-with-r" class="section level2">
<h2>Question 2 (Exercise 6.B in “Statistical Computing with R”)</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’ s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in cor.test. Show (empirically) that the nonparametric tests based on
<span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y )\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="analysis-8" class="section level3">
<h3>Analysis</h3>
<p>If there are two variables: <span class="math inline">\(X\)</span>
and <span class="math inline">\(Y\)</span>, the meaning of the final
calculated correlation coefficient can be understood as follows:</p>
<ol style="list-style-type: decimal">
<li><p>When the correlation coefficient is <span class="math inline">\(0\)</span>, there is no relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p></li>
<li><p>When the value of <span class="math inline">\(X\)</span>
increases (decreases) and the value of <span class="math inline">\(Y\)</span> increases (decreases), the two
variables are positively correlated, and the correlation coefficient is
between <span class="math inline">\(0.00\)</span> and <span class="math inline">\(1.00\)</span>.</p></li>
<li><p>When the value of <span class="math inline">\(X\)</span>
increases (decreases) and the value of <span class="math inline">\(Y\)</span> decreases (increases), the two
variables are negatively correlated, and the correlation coefficient is
between <span class="math inline">\(-1.00\)</span> and <span class="math inline">\(0.00\)</span>.</p></li>
</ol>
<p>Assuming that there are two variables X and Y, then the Pearson
product moment correlation between the two variables can be calculated
by the following formula:<span class="math display">\[
\rho_{X, Y}=\frac{\operatorname{cov}(X, Y)}{\sigma_X
\sigma_Y}=\frac{E\left(\left(X-\mu_X\right)\left(Y-\mu_Y\right)\right)}{\sigma_X
\sigma_Y}=\frac{E(X Y)-E(X) E(Y)}{\sqrt{E\left(X^2\right)-E^2(X)}
\sqrt{E\left(Y^2\right)-E^2(Y)}}
\]</span> The correlation coefficient is defined when the standard
deviation of both variables is not zero, and the Pearson product moment
correlation is applied to:</p>
<ol style="list-style-type: decimal">
<li><p>There is a linear relationship between the two variables, and
they are both continuous data.</p></li>
<li><p>The population of the two variables is normally distributed, or
nearly normal, with a unimodal distribution.</p></li>
<li><p>The observations of the two variables are paired, and each pair
of observations is independent of each other.</p></li>
</ol>
<p>The Spearman rank correlation coefficient between the random
variables X and Y can be calculated from the ranking set x,y or the
ranking difference set d. It is calculated from the set of rankings x
and y (the correlation coefficient of Spearman’s rank is also considered
to be the Pearson product moment correlation of the two immediate
variables that pass through the ranking, and the following is actually
the Pearson product moment correlation of x, y is actually calculated):
<span class="math display">\[
\rho_s=\frac{\sum_{i=1}^N\left(x_i-\bar{x}\right)\left(y_i-\bar{y}\right)}{\sqrt{\sum_{i=1}^N\left(x_i-\bar{x}\right)^2
\sum_{i=1}^N\left(y_i-\bar{y}\right)^2}}
\]</span></p>
<p>Suppose that the two random variables are <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (which can also be regarded as two
sets), and the number of elements in them is <span class="math inline">\(N\)</span>, and the <span class="math inline">\(i\
(1 \leq i \leq N)\)</span> values of the two subsequent variables are
represented by <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> respectively. The corresponding
elements in <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> form a set of element pairs <span class="math inline">\(XY\)</span>. When any two elements <span class="math inline">\((X_i, Y_i)\)</span> and <span class="math inline">\((X_j, Y_j)\)</span> in the set <span class="math inline">\(XY\)</span> are ranked the same, they are
considered to be consistent, whereas they are considered to be
inconsistent.</p>
<p>Formula for calculating Kendall correlation coefficient: <span class="math display">\[
\tau = \frac{C-D}{\frac{1}{2} N(N-1)}.
\]</span> where <span class="math inline">\(C\)</span> indicates that
there is a consistent logarithm of elements in <span class="math inline">\(XY\)</span> (two elements are a pair); <span class="math inline">\(D\)</span> indicates that there are inconsistent
logarithms of elements in <span class="math inline">\(XY\)</span>.</p>
</div>
<div id="experiments-1" class="section level3">
<h3>Experiments</h3>
<ol style="list-style-type: decimal">
<li>data generate 1: (the sampled distribution is bivariate normal)</li>
</ol>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a><span class="co"># set seed and create data vectors</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>sample_meanvector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>sample_covariance_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>                                   <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a><span class="co"># create bivariate normal distribution</span></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>sample_distribution <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> sample_size,</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>                               <span class="at">mu =</span> sample_meanvector, </span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>                               <span class="at">Sigma =</span> sample_covariance_matrix)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>data generate 2: (the sampled distribution is <span class="math inline">\(F(x) = x^3,\ 0 \leq x \leq 1\)</span>)</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="cf">function</span>(sample_size){</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(sample_size)</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> u<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>} <span class="co"># F(x) = x^3, 0&lt;=x&lt;=1</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cbind</span>(u,x))</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>}</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">alternative</span>(sample_size)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>compute kinds of correlation coefficients:</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co">#correlation coefficient</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>Comparate_cor <span class="ot">&lt;-</span> <span class="cf">function</span>(sample_distribution){</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  COR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  COR[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(sample_distribution[,<span class="dv">1</span>], sample_distribution[,<span class="dv">2</span>],</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  COR[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(sample_distribution[,<span class="dv">1</span>], sample_distribution[,<span class="dv">2</span>],</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  COR[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(sample_distribution[,<span class="dv">1</span>], sample_distribution[,<span class="dv">2</span>],</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  COR</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>}</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a><span class="co"># the result of experiments</span></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a><span class="co"># the sampled distribution is bivariate normal</span></span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>COR1 <span class="ot">&lt;-</span> <span class="fu">Comparate_cor</span>(sample_distribution)</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a><span class="co"># the sampled distribution is F(x) = x^3, 0&lt;=x&lt;=1</span></span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>COR2 <span class="ot">&lt;-</span> <span class="fu">Comparate_cor</span>(X)</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a><span class="co"># turn: &quot;pearson&quot; -&gt; &quot;spearman&quot; -&gt; &quot;kendall&quot;</span></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a><span class="fu">round</span>(COR1,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.4931 0.4713 0.3260</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">round</span>(COR2,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.9552 1.0000 1.0000</code></pre>
</div>
<div id="question-3-homework-in-class" class="section level3">
<h3>Question 3 (Homework in class)</h3>
<p>If we obtain the powers for two methods under a particular simulation
setting with <span class="math inline">\(10,000\)</span> experiments:
say, <span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. We want to know
if the powers are different at <span class="math inline">\(0.05\)</span>
level.</p>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test
or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis
testing.</p></li>
</ol>
</div>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li><p>The hypothesis test problem is <span class="math display">\[H_0:
p_1 = p_2 \leftrightarrow H_1: p_1 \neq p_2.\]</span> the powers for one
method is <span class="math inline">\(p_1\)</span>, for the other method
is <span class="math inline">\(p_2\)</span>.</p></li>
<li><p>Can’t use:</p></li>
</ol>
<p>Can use:</p>
<ol start="3" style="list-style-type: decimal">
<li>The note as below:</li>
</ol>
<p>For all: The number of observations of the two samples is the same,
and the order of the observations of the two samples cannot be changed
arbitrarily.</p>
<p>For paired-t test: The dependent variable is measured at an
incremental level, such as a ratio or interval. indeed, The argument
must consist of two related groups or matching pairs.</p>
<p>For McNemar test: the McNemar change significance test requires that
the observed values of the two groups of samples to be tested are
dichotomous data, and when the observed values of the two paired samples
are not binary data, the former test method cannot be used, and the sign
test of the two paired samples can be used.</p>
</div>
</div>
</div>
<div id="homework-2024-10-14" class="section level1">
<h1>Homework-2024-10-14</h1>
<div id="question-1-homework-in-class" class="section level2">
<h2>Question 1 (Homework in class)</h2>
<p>Of <span class="math inline">\(N = 1000\)</span> hypotheses, <span class="math inline">\(950\)</span> are null and <span class="math inline">\(50\)</span> are alternative.The p-value under any
null hypothesis is uniformly distributed(use runif), and the p-value
under any alternative hypothesis follows the beta distribution with
parameter <span class="math inline">\(0.1\)</span> and <span class="math inline">\(1\)</span> (use rbeta). Obtain Bonferroni adjusted
p-values and B-H adjusted p-values. Calculate FWER, FDR, and TPR under
nominal level <span class="math inline">\(\alpha = 0.1\)</span> for each
of the two adjustment methods based on <span class="math inline">\(m =
10000\)</span> simulation replicates. You should output the <span class="math inline">\(6\)</span> numbers to a <span class="math inline">\(3 \times 2\)</span> table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR,
TPR).Comment the results.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div id="analysis-9" class="section level3">
<h3>Analysis</h3>
<ol style="list-style-type: decimal">
<li><p>False positive rate (FPR) = <span class="math inline">\(V/m_0\)</span>.</p></li>
<li><p>True positive rate (TPR) = <span class="math inline">\(S/(m-m0)\)</span>.</p></li>
<li><p>False negative rate (FNR) = <span class="math inline">\(T/(m-m0)\)</span>.</p></li>
<li><p>True negative rate (TNR) = <span class="math inline">\(U/m_0\)</span>.</p></li>
<li><p>False discovery rate (FDR) = <span class="math inline">\(V/R\)</span>.</p></li>
<li><p>True discovery rate (TDR) = <span class="math inline">\(S/R\)</span>.</p></li>
<li><p>Family-wise error rate (FWER) = <span class="math inline">\(P(\mbox{reject any null hypothesis} \mid \text{all
}N\mbox{ null hypotheses are true})\)</span>.</p></li>
</ol>
</div>
<div id="experiments-2" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>hypotheses_null_num <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>hypotheses_alternative_num <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> hypotheses_null_num <span class="sc">+</span> hypotheses_alternative_num</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>labels_hypotheses <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>labels_hypotheses[<span class="dv">1</span><span class="sc">:</span>hypotheses_null_num] <span class="ot">&lt;-</span> </span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>,hypotheses_null_num)</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>labels_hypotheses[(hypotheses_null_num<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N] <span class="ot">&lt;-</span></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">1</span>,hypotheses_alternative_num)</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>data_generate <span class="ot">&lt;-</span> <span class="cf">function</span>(n1,n2,m){</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  Data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> (n1<span class="sc">+</span>n2), <span class="at">ncol =</span> m)</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>    data_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(n1)</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>    data_alternative <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n2,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n1<span class="sc">+</span>n2)</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>    data[<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> data_null</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>    data[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n1<span class="sc">+</span>n2)] <span class="ot">&lt;-</span> data_alternative</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>    Data[,i] <span class="ot">&lt;-</span> data</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a>  }</span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>  <span class="fu">return</span>(Data)</span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>}</span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">data_generate</span>(hypotheses_null_num,</span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a>                      hypotheses_alternative_num,m)</span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a>Bonferroni <span class="ot">&lt;-</span> <span class="cf">function</span>(data,m,N){</span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a>  Data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> m)</span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb60-28"><a href="#cb60-28" tabindex="-1"></a>    Data[,i] <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(data[,i],<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb60-29"><a href="#cb60-29" tabindex="-1"></a>  }</span>
<span id="cb60-30"><a href="#cb60-30" tabindex="-1"></a>  <span class="fu">return</span>(Data)</span>
<span id="cb60-31"><a href="#cb60-31" tabindex="-1"></a>}</span>
<span id="cb60-32"><a href="#cb60-32" tabindex="-1"></a>BH <span class="ot">&lt;-</span> <span class="cf">function</span>(data,m,N){</span>
<span id="cb60-33"><a href="#cb60-33" tabindex="-1"></a>  Data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> m)</span>
<span id="cb60-34"><a href="#cb60-34" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb60-35"><a href="#cb60-35" tabindex="-1"></a>    Data[,i] <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(data[,i],<span class="at">method =</span> <span class="st">&#39;BH&#39;</span>)</span>
<span id="cb60-36"><a href="#cb60-36" tabindex="-1"></a>  }</span>
<span id="cb60-37"><a href="#cb60-37" tabindex="-1"></a>  <span class="fu">return</span>(Data)</span>
<span id="cb60-38"><a href="#cb60-38" tabindex="-1"></a>}</span>
<span id="cb60-39"><a href="#cb60-39" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb60-40"><a href="#cb60-40" tabindex="-1"></a></span>
<span id="cb60-41"><a href="#cb60-41" tabindex="-1"></a>Data.Bonferroni <span class="ot">&lt;-</span> <span class="fu">Bonferroni</span>(Data,m,N)</span>
<span id="cb60-42"><a href="#cb60-42" tabindex="-1"></a>Data.BH <span class="ot">&lt;-</span> <span class="fu">BH</span>(Data,m,N)</span>
<span id="cb60-43"><a href="#cb60-43" tabindex="-1"></a>FDR.Bonferroni <span class="ot">&lt;-</span> FDR.BH <span class="ot">&lt;-</span> TPR.Bonferroni <span class="ot">&lt;-</span> TPR.BH <span class="ot">&lt;-</span></span>
<span id="cb60-44"><a href="#cb60-44" tabindex="-1"></a>  FWER.Bonferroni <span class="ot">&lt;-</span> FWER.BH <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb60-45"><a href="#cb60-45" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb60-46"><a href="#cb60-46" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">sum</span>(Data.Bonferroni[,i] <span class="sc">&lt;=</span> alpha)</span>
<span id="cb60-47"><a href="#cb60-47" tabindex="-1"></a>  V <span class="ot">&lt;-</span> <span class="fu">sum</span>(Data.Bonferroni[<span class="dv">1</span><span class="sc">:</span>hypotheses_null_num,i] <span class="sc">&lt;=</span> alpha)</span>
<span id="cb60-48"><a href="#cb60-48" tabindex="-1"></a>  S <span class="ot">&lt;-</span> R<span class="sc">-</span>V</span>
<span id="cb60-49"><a href="#cb60-49" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">sum</span>(Data.Bonferroni[(<span class="dv">1</span><span class="sc">+</span>hypotheses_null_num)<span class="sc">:</span>N,i] <span class="sc">&lt;=</span> alpha)</span>
<span id="cb60-50"><a href="#cb60-50" tabindex="-1"></a>  TT <span class="ot">&lt;-</span> N<span class="sc">-</span>R<span class="sc">-</span>U</span>
<span id="cb60-51"><a href="#cb60-51" tabindex="-1"></a>  FDR.Bonferroni[i] <span class="ot">&lt;-</span> V<span class="sc">/</span>R</span>
<span id="cb60-52"><a href="#cb60-52" tabindex="-1"></a>  TPR.Bonferroni[i] <span class="ot">&lt;-</span> S<span class="sc">/</span>hypotheses_alternative_num</span>
<span id="cb60-53"><a href="#cb60-53" tabindex="-1"></a>  <span class="cf">if</span> (V<span class="sc">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb60-54"><a href="#cb60-54" tabindex="-1"></a>    FWER.Bonferroni[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb60-55"><a href="#cb60-55" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb60-56"><a href="#cb60-56" tabindex="-1"></a>    FWER.Bonferroni[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb60-57"><a href="#cb60-57" tabindex="-1"></a>  }</span>
<span id="cb60-58"><a href="#cb60-58" tabindex="-1"></a>}</span>
<span id="cb60-59"><a href="#cb60-59" tabindex="-1"></a></span>
<span id="cb60-60"><a href="#cb60-60" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb60-61"><a href="#cb60-61" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="fu">sum</span>(Data.BH[,i] <span class="sc">&lt;=</span> alpha)</span>
<span id="cb60-62"><a href="#cb60-62" tabindex="-1"></a>  V <span class="ot">&lt;-</span> <span class="fu">sum</span>(Data.BH[<span class="dv">1</span><span class="sc">:</span>hypotheses_null_num,i] <span class="sc">&lt;=</span> alpha)</span>
<span id="cb60-63"><a href="#cb60-63" tabindex="-1"></a>  S <span class="ot">&lt;-</span> R<span class="sc">-</span>V</span>
<span id="cb60-64"><a href="#cb60-64" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">sum</span>(Data.BH[(<span class="dv">1</span><span class="sc">+</span>hypotheses_null_num)<span class="sc">:</span>N,i] <span class="sc">&lt;=</span> alpha)</span>
<span id="cb60-65"><a href="#cb60-65" tabindex="-1"></a>  TT <span class="ot">&lt;-</span> N<span class="sc">-</span>R<span class="sc">-</span>U</span>
<span id="cb60-66"><a href="#cb60-66" tabindex="-1"></a>  FDR.BH[i] <span class="ot">&lt;-</span> V<span class="sc">/</span>R</span>
<span id="cb60-67"><a href="#cb60-67" tabindex="-1"></a>  TPR.BH[i] <span class="ot">&lt;-</span> S<span class="sc">/</span>hypotheses_alternative_num</span>
<span id="cb60-68"><a href="#cb60-68" tabindex="-1"></a>  <span class="cf">if</span> (V<span class="sc">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb60-69"><a href="#cb60-69" tabindex="-1"></a>    FWER.BH[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb60-70"><a href="#cb60-70" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb60-71"><a href="#cb60-71" tabindex="-1"></a>    FWER.BH[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb60-72"><a href="#cb60-72" tabindex="-1"></a>  }</span>
<span id="cb60-73"><a href="#cb60-73" tabindex="-1"></a>}</span>
<span id="cb60-74"><a href="#cb60-74" tabindex="-1"></a></span>
<span id="cb60-75"><a href="#cb60-75" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb60-76"><a href="#cb60-76" tabindex="-1"></a>result[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(FWER.Bonferroni),<span class="fu">mean</span>(FDR.Bonferroni),<span class="fu">mean</span>(TPR.Bonferroni))</span>
<span id="cb60-77"><a href="#cb60-77" tabindex="-1"></a>result[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(FWER.BH),<span class="fu">mean</span>(FDR.BH),<span class="fu">mean</span>(TPR.BH))</span>
<span id="cb60-78"><a href="#cb60-78" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result,<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>,<span class="st">&quot;BH&quot;</span>))</span>
<span id="cb60-79"><a href="#cb60-79" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb60-80"><a href="#cb60-80" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##              FWER         FDR      TPR
## Bonferroni 0.0928 0.004802325 0.397138
## BH         0.9321 0.094926487 0.561094</code></pre>
</div>
</div>
<div id="question-2-exercise-7.4-in-statistical-computing-with-r" class="section level2">
<h2>Question 2 (Exercise 7.4 in “Statistical Computing with R”)</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The <span class="math inline">\(12\)</span> observations are
the times in hours between failures of air-conditioning equipment [<span class="math inline">\(63\)</span>, Example <span class="math inline">\(1.1\)</span>]: <span class="math display">\[3, 5,
7, 18, 43, 85, 91, 98, 100, 130, 230, 487.\]</span> Assume that the
times between failures follow an exponential model <span class="math inline">\(\operatorname{Exp}(\lambda)\)</span>. Obtain the
MLE of the hazard rate <span class="math inline">\(\lambda\)</span> and
use bootstrap to estimate the bias and standard error of the
estimate.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div id="analysis-10" class="section level3">
<h3>Analysis</h3>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the <span class="math inline">\(MLE\)</span> of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda} = \frac{1}{\bar{X}}\)</span>, where
<span class="math inline">\(\bar{X}\)</span> is the sample mean.</p>
</div>
<div id="experiments-3" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.array</span>(aircondit<span class="sc">$</span>hours)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x))</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>} </span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>SIZE <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>Mboot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sample</span>(data, <span class="at">size =</span> SIZE, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>  <span class="fu">MLE</span>(y)</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>})</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias =</span> <span class="fu">mean</span>(Mboot) <span class="sc">-</span> <span class="fu">MLE</span>(data),<span class="at">se =</span> <span class="fu">sd</span>(Mboot)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  bias    se 
## 0.001 0.004</code></pre>
</div>
</div>
<div id="question-3-exercise-7.5-in-statistical-computing-with-r" class="section level2">
<h2>Question 3 (Exercise 7.5 in “Statistical Computing with R”)</h2>
<p>Refer to Exercise <span class="math inline">\(7.4\)</span>. Compute
<span class="math inline">\(95\%\)</span> bootstrap confidence intervals
for the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal,
basic, percentile, and BCa methods. Compare the intervals and explain
why they may differ.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div id="analysis-11" class="section level3">
<h3>Analysis</h3>
<ol style="list-style-type: decimal">
<li><p>The standard bootstrap CI based on asymptotic normality (<a href>normal</a>):<span class="math display">\[(\hat\theta-z_{1-\alpha/2}\hat{se}(\hat\theta),\hat\theta-z_{\alpha/2}\hat{se}(\hat\theta)).\]</span></p></li>
<li><p>The basic bootstrap CI based on the large sample property (<a href>basic</a>):The resulting <span class="math inline">\((1-\alpha)\)</span>-CI is <span class="math display">\[(2\hat\theta-\hat\theta^*_{1-\alpha/2},2\hat\theta-\hat\theta^*_{\alpha/2}).\]</span>where
<span class="math inline">\(\hat\theta^*_a\)</span> is the <span class="math inline">\(a\)</span>-quantile of <span class="math inline">\(\hat\theta^*\)</span>.</p></li>
<li><p>Percentile CI (<a href>percent</a>) by assuming <span class="math inline">\(\hat\theta^*|\textbf{X}\)</span> and <span class="math inline">\(\hat\theta\)</span> have approximately the same
distribution: <span class="math display">\[(\hat\theta^*_{\alpha/2},\hat\theta^*_{1-\alpha/2}).\]</span></p></li>
<li><p>Bias-corrected and accelerated CI (<a href>BCa</a>): <span class="math display">\[(\hat\theta^*_{\alpha_1},\hat\theta^*_{\alpha_2})\]</span>
<span class="math display">\[\alpha_1=\Phi(\hat z_0+\frac{\hat
z_0+z_{\alpha/2}}{1-\hat a (\hat z_0+z_{\alpha/2})}), \alpha_2=\Phi(\hat
z_0+\frac{\hat z_0+z_{1-\alpha/2}}{1-\hat a (\hat
z_0+z_{1-\alpha/2})})\]</span> <span class="math display">\[\hat
z_0=\Phi^{-1}\left(\frac1B\sum_{b=1}^BI(\hat\theta^{(b)}&lt;\hat\theta)\right),
\hat a=\frac{\sum_{i=1}^n(\bar{\theta}_{(\cdot)}-\theta_{i})^3}
{6\sum_{i=1}^n((\bar{\theta}_{(\cdot)}-\theta_{i})^2)^{3/2}}\]</span></p></li>
</ol>
</div>
<div id="experiments-4" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.array</span>(aircondit<span class="sc">$</span>hours)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>SIZE <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e2</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>boot.MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(data,<span class="at">statistic=</span>boot.MLE, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">conf =</span> <span class="fl">0.95</span>,</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>                <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)) <span class="co"># level: 0.95</span></span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>}</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a><span class="co"># The standard bootstrap CI based on asymptotic normality</span></span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>])),<span class="dv">4</span>) </span></code></pre></div>
<pre><code>## [1]  34.3619 181.7749</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>])),<span class="dv">4</span>) <span class="co"># The basic bootstrap CI</span></span></code></pre></div>
<pre><code>## [1]  24.3300 169.2142</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>])),<span class="dv">4</span>) <span class="co"># Percentile CI</span></span></code></pre></div>
<pre><code>## [1]  46.9525 191.8367</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.bca[,<span class="dv">2</span>])),<span class="dv">4</span>) <span class="co"># Bias-corrected and accelerated CI</span></span></code></pre></div>
<pre><code>## [1]  57.1079 226.6971</code></pre>
<p>Different methods may treat extreme values or the shape of the
distribution differently, leading to differences in confidence
intervals.</p>
</div>
</div>
</div>
<div id="homework-2024-10-21" class="section level1">
<h1>Homework-2024-10-21</h1>
<div id="question-1-exercise-7.7-7.8-in-statistical-computing-with-r" class="section level2">
<h2>Question 1 (Exercise 7.7-7.8 in “Statistical Computing with R”)</h2>
<div id="section" class="section level3">
<h3>7.7</h3>
<p>Refer to Exercise <span class="math inline">\(7.6\)</span>. Efron and
Tibshirani discuss the following example. The five-dimensional scores
data have a <span class="math inline">\(5 \times 5\)</span> covariance
matrix <span class="math inline">\(\Sigma\)</span>, with positive
eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. In
principal components analysis, <span class="math display">\[
\theta=\frac{\lambda_1}{\sum_{j=1}^5 \lambda_j}
\]</span> measures the proportion of variance explained by the first
principal component. Let <span class="math inline">\(\hat{\lambda}_1&gt;\cdots&gt;\hat{\lambda}_5\)</span>
be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,
where <span class="math inline">\(\hat{\Sigma}\)</span> is the <span class="math inline">\(MLE\)</span> of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^5 \hat{\lambda}_j}
\]</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap
to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="section-1" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise <span class="math inline">\(7.7\)</span>. Obtain
the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div id="analysis-12" class="section level3">
<h3>Analysis</h3>
<p>From exercise <span class="math inline">\(7.6\)</span>, Efron and
Tibshirani discuss the scor (bootstrap) test score data on <span class="math inline">\(88\)</span> students who took examinations in five
subjects. The first two tests (mechanics, vectors) were closed book and
the last three tests (algebra, analysis, statistics) were open book.
Each row of the data frame is a set of scores <span class="math inline">\(\left(x_{i 1}, \ldots, x_{i 5}\right)\)</span> for
the <span class="math inline">\(i^{t h}\)</span> student.</p>
</div>
<div id="experiments-5" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="fu">attach</span>(scor)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a><span class="fu">head</span>(scor)</span></code></pre></div>
<pre><code>##   mec vec alg ana sta
## 1  77  82  67  67  81
## 2  63  78  80  70  81
## 3  75  73  71  66  81
## 4  55  72  63  70  68
## 5  63  63  65  70  63
## 6  53  61  72  64  73</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e3</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(scor)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>straight_T <span class="ot">&lt;-</span> <span class="cf">function</span>(cor_matrix){</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cor_matrix)</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>  <span class="fu">max</span>(ev<span class="sc">$</span>val[<span class="dv">1</span>]) <span class="sc">/</span> <span class="fu">sum</span>(ev<span class="sc">$</span>val)</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>} <span class="co"># 直接求出的参数估计</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>bootstrap_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>  xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>  ndata <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(data)<span class="sc">*</span><span class="fu">ncol</span>(data)),<span class="at">nrow =</span> <span class="fu">nrow</span>(data),<span class="at">ncol =</span> <span class="fu">ncol</span>(data))</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) ndata[i,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data[xstar[i],])</span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>  ndata <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ndata)</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>  <span class="fu">colnames</span>(ndata) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data)</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>  <span class="fu">return</span>(ndata)</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a>} <span class="co"># 重排数据生成</span></span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>bootstrap_T <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a>  <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>    ndata <span class="ot">&lt;-</span> <span class="fu">bootstrap_data</span>(data)</span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>    cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(ndata)</span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>    ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cor_matrix)</span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a>    total[b] <span class="ot">&lt;-</span> <span class="fu">max</span>(ev<span class="sc">$</span>val[<span class="dv">1</span>]) <span class="sc">/</span> <span class="fu">sum</span>(ev<span class="sc">$</span>val)</span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a>  }</span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a>  total</span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a>} <span class="co"># bootstrap方法求出的theta估计</span></span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a></span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a>jackknife_T <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb74-29"><a href="#cb74-29" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(data))</span>
<span id="cb74-30"><a href="#cb74-30" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) {</span>
<span id="cb74-31"><a href="#cb74-31" tabindex="-1"></a>    ndata <span class="ot">&lt;-</span> data[(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data))[<span class="sc">-</span>b],]</span>
<span id="cb74-32"><a href="#cb74-32" tabindex="-1"></a>    cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(ndata)</span>
<span id="cb74-33"><a href="#cb74-33" tabindex="-1"></a>    ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cor_matrix)</span>
<span id="cb74-34"><a href="#cb74-34" tabindex="-1"></a>    total[b] <span class="ot">&lt;-</span> <span class="fu">max</span>(ev<span class="sc">$</span>val[<span class="dv">1</span>]) <span class="sc">/</span> <span class="fu">sum</span>(ev<span class="sc">$</span>val)</span>
<span id="cb74-35"><a href="#cb74-35" tabindex="-1"></a>  }</span>
<span id="cb74-36"><a href="#cb74-36" tabindex="-1"></a>  total</span>
<span id="cb74-37"><a href="#cb74-37" tabindex="-1"></a>} <span class="co"># jackknife方法求出的theta估计</span></span>
<span id="cb74-38"><a href="#cb74-38" tabindex="-1"></a></span>
<span id="cb74-39"><a href="#cb74-39" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb74-40"><a href="#cb74-40" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">straight_T</span>(cor_matrix)</span>
<span id="cb74-41"><a href="#cb74-41" tabindex="-1"></a>theta_bootstrap <span class="ot">&lt;-</span> <span class="fu">bootstrap_T</span>(scor)</span>
<span id="cb74-42"><a href="#cb74-42" tabindex="-1"></a>theta_jackknife <span class="ot">&lt;-</span> <span class="fu">jackknife_T</span>(scor)</span>
<span id="cb74-43"><a href="#cb74-43" tabindex="-1"></a>mean_jackknife <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">mean</span>(theta_jackknife),<span class="fu">nrow</span>(scor))</span>
<span id="cb74-44"><a href="#cb74-44" tabindex="-1"></a>se_jackknife <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta_jackknife<span class="sc">-</span>mean_jackknife)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb74-45"><a href="#cb74-45" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta,<span class="at">bias.bootstrap=</span><span class="fu">mean</span>(theta_bootstrap)<span class="sc">-</span>theta,</span>
<span id="cb74-46"><a href="#cb74-46" tabindex="-1"></a>        <span class="at">se.bootstrap=</span><span class="fu">sd</span>(theta_bootstrap),</span>
<span id="cb74-47"><a href="#cb74-47" tabindex="-1"></a>        <span class="at">bias.jackknife=</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_jackknife)<span class="sc">-</span>theta),</span>
<span id="cb74-48"><a href="#cb74-48" tabindex="-1"></a>        <span class="at">se.jackknife=</span>se_jackknife),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##       original bias.bootstrap   se.bootstrap bias.jackknife   se.jackknife 
##         0.6362         0.0013         0.0418        -0.0004         0.0020</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">detach</span>(scor)</span></code></pre></div>
</div>
</div>
<div id="question-2-exercise-7.10-in-statistical-computing-with-r" class="section level2">
<h2>Question 2 (Exercise 7.10 in “Statistical Computing with R”)</h2>
<p>In Example <span class="math inline">\(7.18\)</span> , leave-one-out
( <span class="math inline">\(n\)</span>-fold) cross validation was used
to select the best fitting model. Repeat the analysis replacing the
<span class="math inline">\(Log-Log\)</span> model with a cubic
polynomial model. Which of the four models is selected by the cross
validation procedure? Which model is selected according to maximum
adjusted <span class="math inline">\(R^2\)</span> ?</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div id="experiments-6" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>) <span class="co">#sequence for plotting fits</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a><span class="co"># 判据：调整的R方</span></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical) <span class="co"># 记为模型1</span></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))<span class="co"># 记为模型2</span></span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))<span class="co"># 记为模型3</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> <span class="fu">log</span>(chemical))<span class="co"># 记为模型4</span></span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>summary1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(L1)</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>summary2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(L2)</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>summary3 <span class="ot">&lt;-</span> <span class="fu">summary</span>(L3)</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>summary4 <span class="ot">&lt;-</span> <span class="fu">summary</span>(L4)</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>ADJ.R.squared_result <span class="ot">&lt;-</span> <span class="fu">c</span>(summary1<span class="sc">$</span>adj.r.squared,summary2<span class="sc">$</span>adj.r.squared,</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>               summary3<span class="sc">$</span>adj.r.squared,summary4<span class="sc">$</span>adj.r.squared)</span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a><span class="fu">which.min</span>(ADJ.R.squared_result)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>CV <span class="ot">&lt;-</span> <span class="cf">function</span>(M,C){</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(M) <span class="co">#in DAAG ironslag</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>    y <span class="ot">&lt;-</span> M[<span class="sc">-</span>k]</span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> C[<span class="sc">-</span>k]</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)<span class="co"># 记为模型1</span></span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> C[k]</span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>    e1[k] <span class="ot">&lt;-</span> M[k] <span class="sc">-</span> yhat1</span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))<span class="co"># 记为模型2</span></span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> C[k] <span class="sc">+</span></span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>      J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> C[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb82-15"><a href="#cb82-15" tabindex="-1"></a>    e2[k] <span class="ot">&lt;-</span> M[k] <span class="sc">-</span> yhat2</span>
<span id="cb82-16"><a href="#cb82-16" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))<span class="co"># 记为模型3</span></span>
<span id="cb82-17"><a href="#cb82-17" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> C[k]</span>
<span id="cb82-18"><a href="#cb82-18" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb82-19"><a href="#cb82-19" tabindex="-1"></a>    e3[k] <span class="ot">&lt;-</span> M[k] <span class="sc">-</span> yhat3</span>
<span id="cb82-20"><a href="#cb82-20" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))<span class="co"># 记为模型4</span></span>
<span id="cb82-21"><a href="#cb82-21" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(C[k])</span>
<span id="cb82-22"><a href="#cb82-22" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb82-23"><a href="#cb82-23" tabindex="-1"></a>    e4[k] <span class="ot">&lt;-</span> M[k] <span class="sc">-</span> yhat4</span>
<span id="cb82-24"><a href="#cb82-24" tabindex="-1"></a>  }</span>
<span id="cb82-25"><a href="#cb82-25" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb82-26"><a href="#cb82-26" tabindex="-1"></a>  result</span>
<span id="cb82-27"><a href="#cb82-27" tabindex="-1"></a>}</span>
<span id="cb82-28"><a href="#cb82-28" tabindex="-1"></a></span>
<span id="cb82-29"><a href="#cb82-29" tabindex="-1"></a>CV_result <span class="ot">&lt;-</span> <span class="fu">CV</span>(<span class="at">M =</span> magnetic, <span class="at">C =</span> chemical)</span>
<span id="cb82-30"><a href="#cb82-30" tabindex="-1"></a><span class="fu">which.min</span>(CV_result)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>For all, Log-Log model is selected according to maximum adjusted
<span class="math inline">\(R^2\)</span>; quadratic polynomial model is
selected by the cross validation procedure.</p>
</div>
</div>
<div id="question-3-exercise-8.1-in-statistical-computing-with-r" class="section level2">
<h2>Question 3 (Exercise 8.1 in “Statistical Computing with R”)</h2>
<p>Implement the two-sample Cramér-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples <span class="math inline">\(8.1\)</span> and <span class="math inline">\(8.2\)</span>.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div id="analysis-13" class="section level3">
<h3>Analysis</h3>
<p>The Cramér-von Mises test is used to test whether a column of data
has the same distribution as another group of data. It is a
nonparametric test method. The one-sample CVM test tests whether the
unknown distribution comes from a parametric distribution, such as a
normal distribution. If you want to compare two groups of data with
unknown distributions, you need a two-sample CVM test.</p>
<p>The one-sample CVM test: <span class="math display">\[
\omega^2=\int_{-\infty}^{\infty}\left[F_N(x)-F(x)\right]^2 d F(x),
\]</span> two-sample CVM test: <span class="math display">\[
T=[N M /(N+M)] \int_{-\infty}^{\infty}\left[F_N(x)-G_M(x)\right]^2 d
H_{N+M}(x).
\]</span></p>
</div>
<div id="experiments-7" class="section level3">
<h3>Experiments</h3>
<p>The data from examples <span class="math inline">\(8.1\)</span> and
<span class="math inline">\(8.2\)</span> are same.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x,y)[<span class="dv">1</span>]</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>  <span class="co">#generate indices k for the first sample</span></span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x1, y1)[<span class="dv">1</span>]</span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a>}</span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&lt;=</span> t0)</span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a><span class="fu">round</span>(p,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.61</code></pre>
<p>p is much larger than usual value 0.05, so the null hypothesis is
rejected. The data are not for same distribution.</p>
</div>
</div>
<div id="question-4-exercise-8.2-in-statistical-computing-with-r" class="section level2">
<h2>Question 4 (Exercise 8.2 in “Statistical Computing with R”)</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence as a permutation test. The Spearman rank correlation test
statistic can be obtained from function cor with method = “spearman”.
Compare the achieved significance level of the permutation test with the
p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div id="analysis-14" class="section level3">
<h3>Analysis</h3>
<p>The bivariate Spearman rank correlation test for independence was
introduced in Homework-2024-09-31, the relative information would be
omitted here.</p>
</div>
<div id="experiments-8" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(state.x77)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> data<span class="sc">$</span>Income</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> data<span class="sc">$</span>Illiteracy</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>result0 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> result0<span class="sc">$</span>p.value</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>  <span class="co">#generate indices k for the first sample</span></span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(y, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="co">#complement of x1</span></span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y1,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> result<span class="sc">$</span>p.value</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>}</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a><span class="fu">round</span>(p,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.968</code></pre>
<p>p is much larger than usual value 0.05, so the alternative hypothesis
is rejected. the two kinds of data from state.x77 are not
independent.</p>
</div>
</div>
</div>
<div id="homework-2024-10-28" class="section level1">
<h1>Homework-2024-10-28</h1>
<div id="question-1-homework-in-class-1" class="section level2">
<h2>Question 1 (Homework in class)</h2>
<div id="algorithm-continuous-situation" class="section level3">
<h3>Algorithm (continuous situation)</h3>
<ul>
<li><p>Target pdf: <span class="math inline">\(f(x)\)</span>.</p></li>
<li><p>Replace <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with <span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span>.</p></li>
<li><p>Proposal distribution (pdf): <span class="math inline">\(g(r|s)\)</span>.</p></li>
<li><p>Acceptance probability: <span class="math inline">\(\alpha(s,r)=\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\)</span>.</p></li>
<li><p>Transition kernel (mixture distribution): <span class="math inline">\(K(r,s)=I(s\not=r)\alpha(r,s)g(s|r)+I(s=r)[1-\int
\alpha(r,s)g(s|r)]\)</span>.</p></li>
<li><p>Stationarity: <span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>.</p></li>
</ul>
<p>proof: the property of the stationarity.</p>
</div>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(s=r\)</span>, the original equation
is right naturally.</p></li>
<li><p><span class="math inline">\(s \neq r\)</span>:</p></li>
</ol>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
K(s,r)f(s) &amp; = \alpha(s,r)g(r|s)f(s) \\
&amp; = (1 \wedge \frac{f(r)g(s|r)}{f(s)g(r|s)})f(s)g(r|s) \\
&amp; = (f(s) \wedge \frac{f(r)g(s|r)}{g(r|s)})g(r|s) \\
&amp; = (f(r) \wedge \frac{f(s)g(r|s)}{g(s|r)})g(r|s) \\
&amp; = f(r)g(r|s)(1 \wedge \frac{f(s)g(r|s)}{f(r)g(s|r)}) \\
&amp; = f(r)K(r,s) \\
\end{aligned}
\end{equation*}\]</span></p>
</div>
<div id="question-2-exercise-9.3-in-statistical-computing-with-r" class="section level2">
<h2>Question 2 (Exercise 9.3 in “Statistical Computing with R”)</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchy or qt with <span class="math inline">\(\mathrm{df}=1\)</span> ). Recall that a <span class="math inline">\(\operatorname{Cauchy}(\theta, \eta)\)</span>
distribution has density function</p>
<p><span class="math display">\[
f(x)=\frac{1}{\theta \pi\left(1+[(x-\eta) / \theta]^2\right)},
\quad-\infty&lt;x&lt;\infty, \theta&gt;0 .
\]</span></p>
<p>The standard Cauchy has the <span class="math inline">\(\operatorname{Cauchy}(\theta=1, \eta=0)\)</span>
density. (Note that the standard Cauchy density is equal to the Student
<span class="math inline">\(t\)</span> density with one degree of
freedom.)</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div id="analysis-15" class="section level3">
<h3>Analysis</h3>
<p>The algorithm (continuous situation) is above. The standard Cauchy
density is equal to the Student <span class="math inline">\(t\)</span>
density with one degree of freedom.</p>
</div>
<div id="experiments-9" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, theta,eta) {</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>  num <span class="ot">&lt;-</span> theta <span class="sc">*</span> pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> ((x <span class="sc">-</span> eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span>num</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>} <span class="co"># theta &gt; 0</span></span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a><span class="co"># 提议分布为N(X,sigma^2)</span></span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> sigma) </span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">mean =</span> xt,<span class="at">sd =</span> sigma)</span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, theta, eta) <span class="sc">*</span> <span class="fu">dnorm</span>(xt,<span class="at">mean =</span> y,<span class="at">sd =</span> sigma)</span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a>  den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, theta, eta) <span class="sc">*</span> <span class="fu">dnorm</span>(y,<span class="at">mean =</span> xt,<span class="at">sd =</span> sigma)</span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den){</span>
<span id="cb88-22"><a href="#cb88-22" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb88-23"><a href="#cb88-23" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb88-24"><a href="#cb88-24" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb88-25"><a href="#cb88-25" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span>     <span class="co">#y is rejected</span></span>
<span id="cb88-26"><a href="#cb88-26" tabindex="-1"></a>  }</span>
<span id="cb88-27"><a href="#cb88-27" tabindex="-1"></a>}</span>
<span id="cb88-28"><a href="#cb88-28" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span></span>
<span id="cb88-29"><a href="#cb88-29" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb88-30"><a href="#cb88-30" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y, <span class="at">probs=</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb88-31"><a href="#cb88-31" tabindex="-1"></a>QC <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">df =</span> <span class="dv">1</span>,<span class="at">p =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb88-32"><a href="#cb88-32" tabindex="-1"></a><span class="fu">round</span>(Q,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    10%    20%    30%    40%    50%    60%    70%    80%    90%   100% 
## -2.371 -1.179 -0.639 -0.304  0.004  0.319  0.745  1.355  2.889 30.968</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">round</span>(QC,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] -3.078 -1.376 -0.727 -0.325  0.000  0.325  0.727  1.376  3.078    Inf</code></pre>
</div>
</div>
<div id="question-3-exercise-9.8-in-statistical-computing-with-r" class="section level2">
<h2>Question 3 (Exercise 9.8 in “Statistical Computing with R”)</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<p><span class="math display">\[
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a,
n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div id="analysis-16" class="section level3">
<h3>Analysis</h3>
</div>
<div id="about-gibbs-sampler" class="section level3">
<h3>About Gibbs sampler</h3>
<ul>
<li><p>Gibbs is named by Geman and Geman (1984) in the application to
the analysis of Gibbs lattice distributions</p></li>
<li><p>Gibbs is ideal for multivariate distributions if it is easy to
sample from each univariate conditional density</p></li>
</ul>
</div>
<div id="algorithm" class="section level3">
<h3>Algorithm</h3>
<ul>
<li><p><span class="math inline">\(X=(X_1,\ldots,X_d)\)</span>: random
vector of interest</p></li>
<li><p><span class="math inline">\(X_{(-j)}=(X_1,\ldots,X_{j-1},X_{j+1},\ldots,X_d)\)</span></p></li>
<li><p>Suppose it is easy to generate random numbers from the
conditional distribution <span class="math inline">\(f(X_j|X_{(-j)})\)</span>.</p></li>
</ul>
</div>
<div id="experiments-10" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a></span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.5</span>) <span class="co">#initialize</span></span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb92-13"><a href="#cb92-13" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb92-14"><a href="#cb92-14" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,x2)</span>
<span id="cb92-15"><a href="#cb92-15" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb92-16"><a href="#cb92-16" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb92-17"><a href="#cb92-17" tabindex="-1"></a>} <span class="co"># 已生成马尔科夫链</span></span>
<span id="cb92-18"><a href="#cb92-18" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" tabindex="-1"></a>B <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb92-20"><a href="#cb92-20" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[B<span class="sc">:</span>N, ]</span>
<span id="cb92-21"><a href="#cb92-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Means: &#39;</span>,<span class="fu">round</span>(<span class="fu">colMeans</span>(x),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Means:  5.14 0.51</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(x),<span class="fu">expression</span>(y)),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-4-extension" class="section level2">
<h2>Question 4 (Extension)</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<div id="experiments-11" class="section level3">
<h3>Experiments</h3>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYil+Y6AAA6ADo6AGY6Ojo6OmY6ZmY6ZrY6kNth0E9mAABmADpmOgBmOjpmZjpmZmZmZpBmtrZmtv+QOgCQZmaQkGaQtraQttuQ2/+2ZgC2Zjq2tpC2tra2ttu229u22/+2/7a2///bkDrbkGbbtrbb/9vb///fU2v/tmb/25D/27b/29v//7b//9v///87LivvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIPElEQVR4nO2dC3vbNBSG3Y3VHQWacGlpCjSjXBoGdiHx//9r+EjyNbY/+aJIbb53z1ovUY6lN7rFUrwoI4NEvjMQOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMA4QYdNpHj37Cg74TFK0C660QdpcfD2GSPosCm17D784yAzITJG0H59XxymZ9PIWIMAI/sgU4XYB/WwX+tR7GzqD+dBEAoCjBO0zQevl6sounh0lJ3wGCVI+fn42BjwW+FeDS4E7df52LW9lMO+Yf7VtFhHgu6LuVDfRPG8Banas2MN6me/fvesqlDa6qXHN23fuBEkU2jF5ULh/OFK0InDuYOCAK4F7TiKOT6vbygIQEEAR4LgqsaZC8KrGuctyOKa9HkLsljVOG9BrEEIvKpx5oLwqsa5Czp1OHdQEICCABQEoCAABQEoCEBBAAoCUBCAggAnFsSVVU/h3EFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAnB3B8D37o7gRflemz9PQSN2dwR/3cN7DTpLQSN2d5ypIPvdHUZQkowKf0I8z4PMxdeEgnrCaUFJW9DRA/5wNIpJz5NaTBSNoDgrfSSKOI6rpF6v9E8Q9Pnh7vfhtEqQGr/6v7OqBahS5zpMI0tKPcpQJcafodGC9t9dXF9ffTF4Rw4RZNT0DvOVIBFiWpVpWcqOONK+9NnlWUldWTIeC52tE2ifIte2iN0ZHZvw0y/y89+7oVsqiKCXKyWod6IYq5Erz78pX2KqTyaPSIpEP6wNJTUi0xy1lbiTeq3rrHr1Xi45ZqKgw8PtD1/dKr7/+rbfkV0NEhmVoCxWTuRE6oeqW5WjKtPFP6V+SaYi/SPKrTQc1U9WFyVVtkWh0xxHSrCROk7Q56df754UDz8//TYgqPg6pu6uu7Iar3TbMfUgM61KZS+rvevHjSd/keqmqgJVPZXKZpS1KlZx6sxIaOSmOIrLhm38TBAkqCZ2+OsbkDx3dPE4cPMXEbQyBclqguLItI/yhPWeJqseK0wVTbNzWqBrpmnDyVHdajbLrHmOVrkhRcLDJnp/FQ130jbh4lWO5CmJi7xmsX4fmz1G1Q93th9jp9EO660xa4yLWdOKTUatS1Qe/ff09Iftq/rDFYISVZHM+5w/pBpY/+virLdcdU+1o5kzTtcz6d7vrGpBsRIUSZ8tbUtLm4UWohTNjKTx9lEjTlaqvsgv023ngrLZgmbRcXLfgjItaJX/yZtOnsHVLEkrHcIw7qV1ahm1fb0LQWres4pMnkzGqhyabNqWs1Y88/paacsyd3goX9WZUesS2SZU4FUN6ZEbgooca1WtkvTWq6pgRXmP0q3akY6eGSqJt1WNJJYeSETkDSyryqcxFaqS1i7KSjWnnoIvibdr0kbQSnqg46c7Ctz20WgkIzI3Em+rGomauUoRO6c9PRVilZnKczI81iCZ9ak6EPR1e2+rGlqQ53mPBd5WNQpBo8J6wNs8KIk7r2QEh0dBdp+mfeNV0LIh3UBBAH8LhxSEwlEQCEdBIBwFgXAUBMK9Cj++t7+Ez4kFed3JMgnWIAAFASgIQEEACgJQEICCABQEoCAABQG8bV4YFc4j3jYvjAnnE29LzyPCecXb5oUR4bzCGgTwtnlhTDifeNu8MCqcRzgPAlAQwKkg852xpcJ5wdEwX12c5zDfhRm8WIN62a9l/KKgAbYXjxQ0SP6B9VgQFw5rvFy9Zw0a5LCJKMj5eX3jWhD/G9Gp5301eBI0FC/8pxZIPide+E/NTw5XNUIpqidBeFUjlKL6EWRxTTqUovoRZLGqEUpRWYOcPDU7OV7VCKWovkYxuKoRSlHDnQe9OSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBgUUFpJPcKRrx8+dxIPHBggbpMLhdfqps5zwvYYklBqdxJGWZkv1ZXI8vEAwcWHDZ5wp14efn42MrGpIBtFhSkLzhuL4dTpXpNpEw8cGCD3mkiC73FVeCZAdssKKjK6wBpdKNKUiYeOLA/tVSP3WUrG3MCViwpSNXx3sv5JVpQkXjgwP7U2zzx9lp3RosErFhQkG7luK2rnJaJBw7szxzdmN2B25uhyFNK9RYEpVHZveSxwxXkq4nVl1jy7ibcJmbbFy7cSe/qS1C5i3A7advRNF1ymC/X6rSFPHa4w7ztfCxdcqL4clXUHyUg76TDnSjKu2kzozedQZl44MDqlIIk3+a/72cHbMMPqwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQIDxBR7sMpm47WAYKAlAQIEhB+/WPa72VRfat/CSCdnoLq2wT26/77mrggkAFyb7n/K9s700j8w/ZKyWbxXpvi+GEQAXd6P2Yalvd1jygdl6l7/789qQtLlBB9+peM+VmPd0NKV/baNpew6kELWhXCjJ3ZruXTb+9N3F0QtCCWjVIOGxup23nnUrQgswGZ/OAYvfh780pB7GwBanBqxzFdG99P3XL/ETCFtScB8lXevIh/rA5ZTcdnqDAoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8DcX5Hx23yjcoAAAAASUVORK5CYII=" /><!-- --><img role="img" src="data:image/png;base64,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CnLJOaWFBnKrBBTkknPKFyoCAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICD/gCJhcqz58x8eVhJveGAgvUVCLbwtdmy1M1jIOyB1On4EM7I41d/y54k3PDBQPJEJZ4rL86vrSjacDJbkG1Cy2BydKxwly0PyxBsemCjZJ6rWTWY7AFoaLMk3oCKvGxSJE30neeIND8xdq+ox26tko41BLe+AdB1v2spRKAGUJd7wwNz1VCaejpNg5MWglm9ASSvHbV3nNE+84YG5Z6G2HKs9ANOTTZYtb+g3AygqfvJC2h4uoL6aWHl7jQw3w21iprHQc5CelbcfSRbDDdKmvWnks5vP92klFKTt4XbzpuOxyOdA8Xk/qz8agAzSwx0o6h/iMshGGgzyxBseGLlUUsmnIvuh0zYGS+KHVSACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgoP8DxRU25Xc4eKYAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-2024-11-04" class="section level1">
<h1>Homework-2024-11-04</h1>
<div id="question-1-exercise-11.3-in-statistical-computing-with-r" class="section level2">
<h2>Question 1 (Exercise 11.3 in “Statistical Computing with R”)</h2>
<p>(a). Write a function to compute the <span class="math inline">\(k^{\text {th }}\)</span> term in</p>
<p><span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k} \frac{\|a\|^{2 k+2}}{(2 k+1)(2
k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}
\]</span></p>
<p>where <span class="math inline">\(d \geq 1\)</span> is an integer,
<span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a \in \mathbb{R}^d\)</span> ).</p>
<p>(b). Modify the function so that it computes and returns the sum.</p>
<p>(c). Evaluate the sum when <span class="math inline">\(a=(1,2)^T\)</span>.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<div id="analysis-17" class="section level3">
<h3>Analysis</h3>
<p>Factorial operations, power function operations, Euclidean norm
operations, and gamma function operations have numerical calculation
problems when the dimension <span class="math inline">\(d\)</span> and
the term <span class="math inline">\(k\)</span> are too large, and
logarithmic operations can be used to nest into exponential operations
to process too large or too small data.</p>
</div>
<div id="experiments-12" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="co"># 计算出项数为k_term，维数为dim，向量为vector_a的值</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>numerical <span class="ot">&lt;-</span> <span class="cf">function</span>(k_term,dim,vector_a){</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  factorial_k <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k_term)</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_term) factorial_k[i] <span class="ot">&lt;-</span> <span class="fu">log</span>(i)</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>  <span class="co"># 先对数化</span></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>  term_1 <span class="ot">&lt;-</span> <span class="sc">-</span>(k_term<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>(factorial_k))</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sum</span>(vector_a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>  term_2 <span class="ot">&lt;-</span> (k_term<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(norm_a)</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>  term_3 <span class="ot">&lt;-</span> <span class="fu">lgamma</span>((dim<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k_term<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k_term<span class="sc">+</span>dim<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>  term <span class="ot">&lt;-</span> term_1<span class="sc">+</span>term_2<span class="sc">+</span>term_3</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  <span class="co"># 再指数化代入</span></span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  result <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k_term <span class="sc">*</span> <span class="fu">exp</span>(term) <span class="sc">/</span> ((<span class="dv">2</span><span class="sc">*</span>k_term<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k_term<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>}</span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a>dim <span class="ot">&lt;-</span> <span class="dv">100</span>; vector_a <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">2</span>,dim); k_term <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">numerical</span>(k_term,dim,vector_a)</span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a><span class="fu">round</span>(result,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 9.41339e+29</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="co"># 项数求和，最终定会收敛</span></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>sum_numerical <span class="ot">&lt;-</span> <span class="cf">function</span>(d,a){</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>  minus <span class="ot">&lt;-</span> <span class="fu">numerical</span>(k,d,a)</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>  Sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(minus) <span class="sc">&gt;=</span> <span class="fl">1e-8</span>) {</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>    Sum <span class="ot">&lt;-</span> Sum <span class="sc">+</span> minus; k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> </span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>    minus <span class="ot">&lt;-</span> <span class="fu">numerical</span>(k,d,a)</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>  }</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>  Sum</span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>}</span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span> ; a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>); SUM <span class="ot">&lt;-</span> <span class="fu">sum_numerical</span>(d,a)</span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a><span class="fu">round</span>(SUM,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] -0.4313</code></pre>
</div>
</div>
<div id="question-2-exercise-11.5-in-statistical-computing-with-r" class="section level2">
<h2>Question 2 (Exercise 11.5 in “Statistical Computing with R”)</h2>
<p>Write a function to solve the equation</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)}
\Gamma\left(\frac{k-1}{2}\right)}
\int_0^{c_{k-1}}\left(1+\frac{u^2}{k-1}\right)^{-k / 2} d u \\
&amp; \quad=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\int_0^{c_k}\left(1+\frac{u^2}{k}\right)^{-(k+1) / 2} d u
\end{aligned}
\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where</p>
<p><span class="math display">\[
c_k=\sqrt{\frac{a^2 k}{k+1-a^2}} .
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div id="analysis-18" class="section level3">
<h3>Analysis</h3>
<p>We use the dichotomy to solve the root of the equations between 11.4
and 11.5. In computer science, a binary search algorithm, also known as
a halved search algorithm, is a search algorithm that finds a specific
element in an ordered array. The search process starts with the middle
element of the array, and ends if the middle element is exactly the one
you want to find; If a particular element is larger or smaller than the
intermediate element, it is found in the half of the array that is
greater or smaller than the intermediate element, and the comparison
starts with the intermediate element as at the beginning. If the array
is empty at a step, it cannot be found. This search algorithm narrows
the search in half with each comparison.</p>
</div>
<div id="experiments-13" class="section level3">
<h3>Experiments</h3>
<p>The left side of the two equations is positive near 0 and negative
near 1. The specific code is as follows:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(u, k) {</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  below <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> u <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="sc">-</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(below)</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  re</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>}</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(u, k) {</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>  below <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> u <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> k</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="sc">-</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(below)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>  re</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>}</span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k)</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>  <span class="fu">sqrt</span>(a <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a>rootfinding <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(k <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">lgamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">-</span></span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a>                                    <span class="fu">lgamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a>  res1 <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f1,</span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a>                    <span class="at">lower =</span> <span class="dv">0</span>,</span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a>                    <span class="at">upper =</span> <span class="fu">c</span>(a, k <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb99-21"><a href="#cb99-21" tabindex="-1"></a>                    <span class="at">k =</span> k)</span>
<span id="cb99-22"><a href="#cb99-22" tabindex="-1"></a>  res2 <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f2,</span>
<span id="cb99-23"><a href="#cb99-23" tabindex="-1"></a>                    <span class="at">lower =</span> <span class="dv">0</span>,</span>
<span id="cb99-24"><a href="#cb99-24" tabindex="-1"></a>                    <span class="at">upper =</span> <span class="fu">c</span>(a, k),</span>
<span id="cb99-25"><a href="#cb99-25" tabindex="-1"></a>                    <span class="at">k =</span> k)</span>
<span id="cb99-26"><a href="#cb99-26" tabindex="-1"></a>  re <span class="ot">&lt;-</span> coef <span class="sc">*</span> res1<span class="sc">$</span>value <span class="sc">-</span> res2<span class="sc">$</span>value</span>
<span id="cb99-27"><a href="#cb99-27" tabindex="-1"></a>  re</span>
<span id="cb99-28"><a href="#cb99-28" tabindex="-1"></a>}</span>
<span id="cb99-29"><a href="#cb99-29" tabindex="-1"></a><span class="co"># 11.5结果：</span></span>
<span id="cb99-30"><a href="#cb99-30" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb99-31"><a href="#cb99-31" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb99-32"><a href="#cb99-32" tabindex="-1"></a>  i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb99-33"><a href="#cb99-33" tabindex="-1"></a>  <span class="co"># yleft &lt;- 1; yright &lt;- -1;</span></span>
<span id="cb99-34"><a href="#cb99-34" tabindex="-1"></a>  xleft <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb99-35"><a href="#cb99-35" tabindex="-1"></a>  xright <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(k)</span>
<span id="cb99-36"><a href="#cb99-36" tabindex="-1"></a>  mid <span class="ot">&lt;-</span> <span class="fu">rootfinding</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb99-37"><a href="#cb99-37" tabindex="-1"></a>  epsilon1 <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb99-38"><a href="#cb99-38" tabindex="-1"></a>  de <span class="ot">&lt;-</span> mid</span>
<span id="cb99-39"><a href="#cb99-39" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(de) <span class="sc">&gt;=</span> epsilon1) {</span>
<span id="cb99-40"><a href="#cb99-40" tabindex="-1"></a>    <span class="cf">if</span> (mid <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb99-41"><a href="#cb99-41" tabindex="-1"></a>      xleft <span class="ot">&lt;-</span> (xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb99-42"><a href="#cb99-42" tabindex="-1"></a>      de <span class="ot">&lt;-</span> mid <span class="sc">-</span> <span class="fu">rootfinding</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb99-43"><a href="#cb99-43" tabindex="-1"></a>      mid <span class="ot">&lt;-</span> <span class="fu">rootfinding</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb99-44"><a href="#cb99-44" tabindex="-1"></a>    }</span>
<span id="cb99-45"><a href="#cb99-45" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb99-46"><a href="#cb99-46" tabindex="-1"></a>      xright <span class="ot">&lt;-</span> (xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb99-47"><a href="#cb99-47" tabindex="-1"></a>      de <span class="ot">&lt;-</span> mid <span class="sc">-</span> <span class="fu">rootfinding</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb99-48"><a href="#cb99-48" tabindex="-1"></a>      mid <span class="ot">&lt;-</span> <span class="fu">rootfinding</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb99-49"><a href="#cb99-49" tabindex="-1"></a>    }</span>
<span id="cb99-50"><a href="#cb99-50" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb99-51"><a href="#cb99-51" tabindex="-1"></a>  }</span>
<span id="cb99-52"><a href="#cb99-52" tabindex="-1"></a>  <span class="fu">return</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb99-53"><a href="#cb99-53" tabindex="-1"></a>}</span>
<span id="cb99-54"><a href="#cb99-54" tabindex="-1"></a><span class="co"># 11.5的A(k):</span></span>
<span id="cb99-55"><a href="#cb99-55" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="fu">res1</span>(K)</span>
<span id="cb99-56"><a href="#cb99-56" tabindex="-1"></a><span class="fu">round</span>(root, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 3.3937</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>curves_intersection <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>  S_lower <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="fu">c</span>(a, k <span class="sc">-</span> <span class="dv">1</span>), <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>  S_upper <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="fu">c</span>(a, k), <span class="at">df =</span> k)</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>  <span class="fu">return</span>(S_lower <span class="sc">-</span> S_upper)</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>}</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a>  i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a>  <span class="co"># yleft &lt;- 1; yright &lt;- -1;</span></span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a>  xleft <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb101-10"><a href="#cb101-10" tabindex="-1"></a>  xright <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(k)</span>
<span id="cb101-11"><a href="#cb101-11" tabindex="-1"></a>  mid <span class="ot">&lt;-</span> <span class="fu">curves_intersection</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb101-12"><a href="#cb101-12" tabindex="-1"></a>  epsilon1 <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb101-13"><a href="#cb101-13" tabindex="-1"></a>  de <span class="ot">&lt;-</span> mid</span>
<span id="cb101-14"><a href="#cb101-14" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(de) <span class="sc">&gt;=</span> epsilon1) {</span>
<span id="cb101-15"><a href="#cb101-15" tabindex="-1"></a>    <span class="cf">if</span> (mid <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb101-16"><a href="#cb101-16" tabindex="-1"></a>      xleft <span class="ot">&lt;-</span> (xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb101-17"><a href="#cb101-17" tabindex="-1"></a>      de <span class="ot">&lt;-</span> mid <span class="sc">-</span> <span class="fu">curves_intersection</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb101-18"><a href="#cb101-18" tabindex="-1"></a>      mid <span class="ot">&lt;-</span> <span class="fu">curves_intersection</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb101-19"><a href="#cb101-19" tabindex="-1"></a>    }</span>
<span id="cb101-20"><a href="#cb101-20" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb101-21"><a href="#cb101-21" tabindex="-1"></a>      xright <span class="ot">&lt;-</span> (xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb101-22"><a href="#cb101-22" tabindex="-1"></a>      de <span class="ot">&lt;-</span> mid <span class="sc">-</span> <span class="fu">curves_intersection</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb101-23"><a href="#cb101-23" tabindex="-1"></a>      mid <span class="ot">&lt;-</span> <span class="fu">curves_intersection</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>, k)</span>
<span id="cb101-24"><a href="#cb101-24" tabindex="-1"></a>    }</span>
<span id="cb101-25"><a href="#cb101-25" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb101-26"><a href="#cb101-26" tabindex="-1"></a>  }</span>
<span id="cb101-27"><a href="#cb101-27" tabindex="-1"></a>  <span class="fu">return</span>((xleft <span class="sc">+</span> xright) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb101-28"><a href="#cb101-28" tabindex="-1"></a>}</span>
<span id="cb101-29"><a href="#cb101-29" tabindex="-1"></a><span class="co"># 11.4的A(k):</span></span>
<span id="cb101-30"><a href="#cb101-30" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="fu">res2</span>(K)</span>
<span id="cb101-31"><a href="#cb101-31" tabindex="-1"></a><span class="fu">round</span>(root, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 1.687</code></pre>
<p>There is a gap between the roots solved by the two equations, which
may be related to the fact that the distribution function values are too
close to each other due to the use of the t-distribution.</p>
</div>
</div>
<div id="question-3-extension" class="section level2">
<h2>Question 3 (Extension)</h2>
<p>Suppose <span class="math inline">\(T_1, \ldots, T_n\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
<span class="math inline">\(\lambda\)</span>. Those values greater than
<span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_i=T_i I\left(T_i \leq \tau\right)+\tau
I\left(T_i&gt;\tau\right)\)</span>, <span class="math inline">\(i=1,
\ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span>
and the observed <span class="math inline">\(Y_i\)</span> values are as
follows:</p>
<p><span class="math display">\[
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span></p>
<p>Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: <span class="math inline">\(Y_i\)</span>
follows a mixture distribution).</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div id="analysis-19" class="section level3">
<h3>Analysis</h3>
<p>加入我们已知某个样本的因变量 <span class="math inline">\(T_i\)</span>
是删失的，在实验中途退出。假如退出时间为<span class="math inline">\(3\)</span>，即 <span class="math inline">\(T_i
\geq 3\)</span>。或者我们可以记为 <span class="math inline">\(T_i=3+\)</span>
（后面我们将会谈到，这种删失我们称之为右删失）。在原本的似然中我们应该乘入的项本是
<span class="math inline">\(f_\theta\left(T_i\right)\)</span>
，但由于我们不知道样本的具体取值，这时候似然中乘入的项就应该变成 <span class="math inline">\(P_\theta\left(T_i \geq 3\right)\)</span>
。由于似然是一个相对概念，只要我们对每一个参数 <span class="math inline">\(\theta\)</span>
都用上述的代入方式，似然仍能够表达出相对可能的结果。注意到 <span class="math inline">\(S(t)=P(T \geq t)\)</span>
，之后我们都会用这样的表达。</p>
<p>正式写一下现在的似然，假设有一组样本 <span class="math inline">\(\left\{t_i, \delta_i, x_i\right\}_{i=1}^n\)</span>
。其中:<span class="math inline">\(t_i\)</span>
代表了跟进时间（following-up time），是生存时间 <span class="math inline">\(T_i\)</span> 与删失时间 <span class="math inline">\(C_i\)</span> 的较小值。<span class="math inline">\(\delta_i\)</span> 代表了状态 (status)： <span class="math inline">\(\delta_i=1\)</span>, if <span class="math inline">\(t_i=T_i\)</span>; <span class="math inline">\(\delta_i=0\)</span>, if <span class="math inline">\(t_i=C_i\)</span>. <span class="math inline">\(x_i\)</span>
代表了协变量（covariates），包括感兴趣的其他变量（如身高血压肺活量……）</p>
<p>则其似然（右删失情况）可以表示成：</p>
<p><span class="math display">\[
L\left(\theta ;\left\{t_i\right\}_{i=1}^n\right)=\prod_i\left(f\left(t_i
; \theta\right)\right)^{\delta_i}\left(S\left(t_i ;
\theta\right)\right)^{1-\delta_i}
\]</span></p>
<p>我们来直观理解一下这个式子: 当 <span class="math inline">\(\delta_i=1\)</span>
，代表样本没有右删失，我们直接可以乘入 <span class="math inline">\(f_\theta(t)\)</span> 。而若 <span class="math inline">\(\delta_i=0\)</span>
，则代表样本右删失，我们需要乘相应的生存函数。由于每一个 <span class="math inline">\(\theta\)</span>
我们都是应用同一套法则，所以该似然还能表示相对可能。</p>
<p>再补充一些EM算法的细节：</p>
<p>(1). E-step: 结合前文的似然函数公式，其具体的<span class="math inline">\(Q(\lambda,\lambda_0)\)</span>为：<span class="math display">\[Q(\lambda,\lambda_0) = \Sigma_i
\mathbb{E}[\delta_i|y_{ob},\lambda_0](-log(\lambda)-\frac{x_i}{\lambda})
+ (1 - \mathbb{E}[\delta_i|y_{ob},\lambda_0])
(-\frac{\tau}{\lambda}).\]</span>此式是代入下式的结果：<span class="math inline">\(f(x_i) =
\frac{1}{\lambda}\exp(-\frac{x_i}{\lambda}),x_i&gt;0\)</span>，<span class="math inline">\(\mathbb{P}\{X_i\geq\tau\} =
\exp(-\frac{\tau}{\lambda})\)</span>。代入<span class="math inline">\(\mathbb{E}[\delta_i|y_{ob},\lambda_0]\)</span>的具体表达式：<span class="math display">\[\mathbb{E}[\delta_i|y_{ob},\lambda_0] =
\frac{p(X=7,\delta_i=1|\lambda_0)p(\delta_i=1|\lambda_0)}{p(X=7|\lambda_0)},\]</span>其中：<span class="math inline">\(X|\lambda_0 \sim B(10,p),\
p=\mathbb{P}\{X_i\leq\tau|\lambda_0\}=1-\exp(-\frac{\tau}{\lambda_0})
.\)</span> 综上：<span class="math display">\[\mathbb{E}[\delta_i|y_{ob},\lambda_0] =
\frac{\binom{9}{6}(1-\exp(-\frac{\tau}{\lambda_0}))^6(\exp(-\frac{\tau}{\lambda_0}))^3(1-\exp(-\frac{\tau}{\lambda_0}))}{\binom{10}{7}(1-\exp(-\frac{\tau}{\lambda_0}))^7(\exp(-\frac{\tau}{\lambda_0}))^3}.\]</span></p>
<p>(2). M-step: 对E-step算出的<span class="math inline">\(Q\)</span>函数作最优化即可，要求的是函数极大值点。</p>
</div>
<div id="experiments-14" class="section level3">
<h3>Experiments</h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>trim <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(y))</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>trim[<span class="fu">which</span>(y <span class="sc">==</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>mlogL <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">lambda =</span> <span class="dv">1</span>) {</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>  <span class="co"># minus log-likelihood</span></span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(trim)</span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>  t <span class="ot">&lt;-</span> y</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a>  t[<span class="fu">which</span>(trim <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a>  <span class="co"># 统计未被截断的观察值个数</span></span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a>  trimmed <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(trim <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb103-13"><a href="#cb103-13" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda)</span>
<span id="cb103-14"><a href="#cb103-14" tabindex="-1"></a>  <span class="co"># cons + algebra 为似然函数</span></span>
<span id="cb103-15"><a href="#cb103-15" tabindex="-1"></a>  cons <span class="ot">&lt;-</span> <span class="sc">-</span> trimmed <span class="sc">*</span> <span class="fu">log</span>(lambda) <span class="sc">-</span> (n<span class="sc">-</span>trimmed) <span class="sc">*</span> (tau<span class="sc">/</span>lambda)</span>
<span id="cb103-16"><a href="#cb103-16" tabindex="-1"></a>  algebra <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(t)<span class="sc">/</span>lambda</span>
<span id="cb103-17"><a href="#cb103-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>(cons <span class="sc">+</span> algebra))</span>
<span id="cb103-18"><a href="#cb103-18" tabindex="-1"></a>}</span>
<span id="cb103-19"><a href="#cb103-19" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb103-20"><a href="#cb103-20" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">mle</span>(mlogL) <span class="co"># No additional data are allowed!</span></span>
<span id="cb103-21"><a href="#cb103-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE下的参数lambda估计值:&quot;</span>,<span class="fu">abs</span>(<span class="fu">as.numeric</span>(fit<span class="sc">@</span>coef)))</span></code></pre></div>
<pre><code>## MLE下的参数lambda估计值: 0.9642705</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="co"># 初始化：</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>lambda0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a><span class="co"># EM算法实现</span></span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a><span class="cf">for</span> (step <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>) {</span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>  <span class="co"># E-step：</span></span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>  op <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(trim)</span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a>    t <span class="ot">&lt;-</span> y</span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a>    t[<span class="fu">which</span>(trim <span class="sc">==</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>    trimmed <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(trim <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb105-12"><a href="#cb105-12" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda)</span>
<span id="cb105-13"><a href="#cb105-13" tabindex="-1"></a>    <span class="co"># 计算条件期望</span></span>
<span id="cb105-14"><a href="#cb105-14" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> <span class="fu">choose</span>(n<span class="dv">-1</span>,trimmed<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>tau<span class="sc">/</span>lambda0))<span class="sc">^</span>(trimmed<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>tau<span class="sc">/</span>lambda0))<span class="sc">^</span>(n<span class="sc">-</span>trimmed)</span>
<span id="cb105-15"><a href="#cb105-15" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> delta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>tau<span class="sc">/</span>lambda0))</span>
<span id="cb105-16"><a href="#cb105-16" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> delta <span class="sc">/</span> (<span class="fu">choose</span>(n,trimmed)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>tau<span class="sc">/</span>lambda0))<span class="sc">^</span>(trimmed)<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>tau<span class="sc">/</span>lambda0))<span class="sc">^</span>(n<span class="sc">-</span>trimmed))</span>
<span id="cb105-17"><a href="#cb105-17" tabindex="-1"></a>    <span class="co"># fterm+sterm 是似然函数取条件期望的结果</span></span>
<span id="cb105-18"><a href="#cb105-18" tabindex="-1"></a>    fterm <span class="ot">&lt;-</span> delta <span class="sc">*</span> (<span class="sc">-</span><span class="fu">log</span>(lambda)<span class="sc">-</span><span class="fu">mean</span>(y)<span class="sc">/</span>lambda)</span>
<span id="cb105-19"><a href="#cb105-19" tabindex="-1"></a>    sterm <span class="ot">&lt;-</span> <span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>delta) <span class="sc">*</span> (tau<span class="sc">/</span>lambda)</span>
<span id="cb105-20"><a href="#cb105-20" tabindex="-1"></a>    <span class="fu">return</span>(fterm<span class="sc">+</span>sterm)</span>
<span id="cb105-21"><a href="#cb105-21" tabindex="-1"></a>  }</span>
<span id="cb105-22"><a href="#cb105-22" tabindex="-1"></a>  oldlambda <span class="ot">&lt;-</span> lambda0</span>
<span id="cb105-23"><a href="#cb105-23" tabindex="-1"></a>  <span class="co"># M-step：最大化</span></span>
<span id="cb105-24"><a href="#cb105-24" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">optimize</span>(op,<span class="at">lower=</span><span class="fl">1e-5</span>,<span class="at">upper=</span><span class="fl">1e5</span>,<span class="at">maximum=</span><span class="cn">TRUE</span>)</span>
<span id="cb105-25"><a href="#cb105-25" tabindex="-1"></a>  lambda0 <span class="ot">&lt;-</span> <span class="fu">abs</span>(res<span class="sc">$</span>objective)</span>
<span id="cb105-26"><a href="#cb105-26" tabindex="-1"></a>  <span class="co"># 设阈值：当上一步迭代得到的参数与下一步迭代得到的参数变化很小，即认为收敛</span></span>
<span id="cb105-27"><a href="#cb105-27" tabindex="-1"></a>  threshold <span class="ot">&lt;-</span> <span class="fl">1e-5</span></span>
<span id="cb105-28"><a href="#cb105-28" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(lambda0 <span class="sc">-</span> oldlambda)) <span class="sc">&lt;</span> threshold) <span class="cf">break</span></span>
<span id="cb105-29"><a href="#cb105-29" tabindex="-1"></a>}</span>
<span id="cb105-30"><a href="#cb105-30" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM算法下的参数lambda估计值:&quot;</span>,<span class="fu">abs</span>(lambda0))</span></code></pre></div>
<pre><code>## EM算法下的参数lambda估计值: 0.7689862</code></pre>
</div>
</div>
</div>
<div id="homework-2024-11-11" class="section level1">
<h1>Homework-2024-11-11</h1>
<div id="question-1-exercise-11.7-in-statistical-computing-with-r" class="section level2">
<h2>Question 1 (Exercise 11.7 in “Statistical Computing with R”)</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4 x+2 y+9 z\)</span> subject to</p>
<p><span class="math display">\[
\begin{aligned}
&amp; 2 x+y+z \leq 2 \\
&amp; x-y+3 z \leq 3 \\
&amp; x \geq 0, y \geq 0, z \geq 0
\end{aligned}
\]</span></p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a><span class="fu">library</span>(Rglpk)</span></code></pre></div>
<pre><code>## Loading required package: slam</code></pre>
<pre><code>## Using the GLPK callable library version 5.0</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">9</span>); dir <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>,<span class="st">&quot;&lt;=&quot;</span>,<span class="st">&quot;&gt;=&quot;</span>,<span class="st">&quot;&gt;=&quot;</span>,<span class="st">&quot;&gt;=&quot;</span>)</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>max <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a><span class="fu">Rglpk_solve_LP</span>(obj, mat, dir, rhs,  <span class="at">max =</span> max)</span></code></pre></div>
<pre><code>## $optimum
## [1] 0
## 
## $solution
## [1] 0 0 0
## 
## $status
## [1] 0
## 
## $solution_dual
## [1] 4 2 9
## 
## $auxiliary
## $auxiliary$primal
## [1] 0 0 0 0 0
## 
## $auxiliary$dual
## [1] 0 0 0 0 0
## 
## 
## $sensitivity_report
## [1] NA</code></pre>
<p>So the result above is: <span class="math inline">\(x=0,y=0,z=0\)</span>.</p>
</div>
<div id="question-2-exercise-11.1.2-in-advanced-r" class="section level2">
<h2>Question 2 (Exercise 11.1.2 in “Advanced R”)</h2>
<div id="section-2" class="section level3">
<h3>3</h3>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</p>
<pre><code>formulas &lt;- list(
    mpg ~ disp,mpg ~ I(1 / disp),mpg ~ disp + wt,
    mpg ~ I(1 / disp) + wt
)</code></pre>
</div>
<div id="answer-26" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(mpg <span class="sc">~</span> disp,mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>                 mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt)</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a><span class="fu">lapply</span>(formulas, lm)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="section-3" class="section level3">
<h3>4</h3>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply(). Can you do it
without an anonymous function?</p>
<pre><code>bootstraps &lt;- lapply(1:10, function(i) {
    rows &lt;- sample(1:nrow(mtcars), rep = TRUE)
    mtcars[rows, ]
})</code></pre>
</div>
<div id="answer-27" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span></code></pre></div>
<pre><code>## The following objects are masked from mtcars (pos = 3):
## 
##     am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>    mtcars[rows, ]</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>})</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(i) <span class="fu">lm</span>(bootstraps[[i]]<span class="sc">$</span>mpg<span class="sc">~</span>bootstraps[[i]]<span class="sc">$</span>disp))</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##              28.3316               -0.0385  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.41730              -0.03731  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             31.77841              -0.04799  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.35570              -0.03809  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             31.79236              -0.04756  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             30.07049              -0.04397  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.11656              -0.03891  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             27.97883              -0.03804  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             27.58770              -0.03576  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.63910              -0.03671</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>fit_models <span class="ot">&lt;-</span> <span class="fu">map</span>(bootstraps, <span class="sc">~</span><span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> .))</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>fit_models</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##     28.3316      -0.0385  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    29.41730     -0.03731  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    31.77841     -0.04799  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    29.35570     -0.03809  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    31.79236     -0.04756  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    30.07049     -0.04397  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    29.11656     -0.03891  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    27.97883     -0.03804  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    27.58770     -0.03576  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = .)
## 
## Coefficients:
## (Intercept)         disp  
##    28.63910     -0.03671</code></pre>
<p>The result is displayed above, and I can do it without an anonymous
function by using “map()” function.</p>
</div>
<div id="section-4" class="section level3">
<h3>5</h3>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<pre><code>rsq &lt;- function(mod) summary(mod)$r.squared</code></pre>
</div>
<div id="answer-28" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span></code></pre></div>
<pre><code>## The following objects are masked from mtcars (pos = 4):
## 
##     am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt</code></pre>
<pre><code>## The following objects are masked from mtcars (pos = 5):
## 
##     am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(mpg <span class="sc">~</span> disp,mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>                 mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt)</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>ex3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm)</span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a><span class="fu">lapply</span>(ex3, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>    mtcars[rows, ]</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>})</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>ex4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(i) <span class="fu">lm</span>(bootstraps[[i]]<span class="sc">$</span>mpg<span class="sc">~</span>bootstraps[[i]]<span class="sc">$</span>disp))</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a><span class="fu">lapply</span>(ex4, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7727431
## 
## [[2]]
## [1] 0.7278854
## 
## [[3]]
## [1] 0.6765019
## 
## [[4]]
## [1] 0.6833878
## 
## [[5]]
## [1] 0.7855425
## 
## [[6]]
## [1] 0.688492
## 
## [[7]]
## [1] 0.6857185
## 
## [[8]]
## [1] 0.7231801
## 
## [[9]]
## [1] 0.8072777
## 
## [[10]]
## [1] 0.7341977</code></pre>
</div>
</div>
<div id="question-3-exercise-11.2.5-in-advanced-r" class="section level2">
<h2>Question 3 (Exercise 11.2.5 in “Advanced R”)</h2>
<div id="section-5" class="section level3">
<h3>3</h3>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<pre><code>trials &lt;- replicate(
    100,
    t.test(rpois(10, 10), rpois(7, 10)),
    simplify = FALSE
)</code></pre>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
</div>
<div id="answer-29" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>,<span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(i) trials[[i]]<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.6045784175 0.1820986090 0.9050688894 0.9341268371 0.6055458398
##   [6] 0.4103082379 0.1783830133 0.8725189574 0.7949770681 0.7014793297
##  [11] 0.2794270741 0.4234728836 0.1562990163 0.9084903843 0.6921870762
##  [16] 0.0826540481 0.4117104256 0.8997680425 0.5221974096 0.2418207263
##  [21] 0.9180757328 0.8995623442 0.9381647646 0.7496637663 0.9448403759
##  [26] 0.7616821087 0.2739118710 0.9625163951 0.9557265649 0.0889948611
##  [31] 0.2928250832 0.5301470631 0.4345060793 0.2159571854 0.7830438531
##  [36] 0.5272809956 0.5410628835 0.1152553558 0.4578209540 0.9548846897
##  [41] 0.0916126195 0.4596460907 0.3159213380 0.3006159029 0.6264279427
##  [46] 0.8796291063 0.1453727069 0.4382601465 0.4943872795 0.4660955815
##  [51] 0.2439034009 0.3465738061 0.4019866153 0.3609166846 0.6915817682
##  [56] 0.6862707626 0.8897210960 0.9314382059 0.7861760717 0.4113055062
##  [61] 0.1395005151 0.9407962799 0.4343064870 0.7434510092 0.8929294188
##  [66] 0.1019788180 0.0009461569 0.8896309120 0.7596429560 0.9678314654
##  [71] 0.9331800477 0.0688571707 0.0775466847 0.0500862439 0.8436839587
##  [76] 0.2534886674 0.4474064236 0.3299860428 0.7927042202 0.2300581877
##  [81] 0.7632141048 0.3188780816 0.4974286409 0.6201811857 0.2028166845
##  [86] 0.5635940557 0.3641600924 0.3982048998 0.4430951330 0.7802165953
##  [91] 0.2075854545 0.0567860071 0.6160564655 0.3141170909 0.6556106824
##  [96] 0.8531956084 0.6829191609 0.8755345531 0.7730359458 0.0764580951</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.6045784175 0.1820986090 0.9050688894 0.9341268371 0.6055458398
##   [6] 0.4103082379 0.1783830133 0.8725189574 0.7949770681 0.7014793297
##  [11] 0.2794270741 0.4234728836 0.1562990163 0.9084903843 0.6921870762
##  [16] 0.0826540481 0.4117104256 0.8997680425 0.5221974096 0.2418207263
##  [21] 0.9180757328 0.8995623442 0.9381647646 0.7496637663 0.9448403759
##  [26] 0.7616821087 0.2739118710 0.9625163951 0.9557265649 0.0889948611
##  [31] 0.2928250832 0.5301470631 0.4345060793 0.2159571854 0.7830438531
##  [36] 0.5272809956 0.5410628835 0.1152553558 0.4578209540 0.9548846897
##  [41] 0.0916126195 0.4596460907 0.3159213380 0.3006159029 0.6264279427
##  [46] 0.8796291063 0.1453727069 0.4382601465 0.4943872795 0.4660955815
##  [51] 0.2439034009 0.3465738061 0.4019866153 0.3609166846 0.6915817682
##  [56] 0.6862707626 0.8897210960 0.9314382059 0.7861760717 0.4113055062
##  [61] 0.1395005151 0.9407962799 0.4343064870 0.7434510092 0.8929294188
##  [66] 0.1019788180 0.0009461569 0.8896309120 0.7596429560 0.9678314654
##  [71] 0.9331800477 0.0688571707 0.0775466847 0.0500862439 0.8436839587
##  [76] 0.2534886674 0.4474064236 0.3299860428 0.7927042202 0.2300581877
##  [81] 0.7632141048 0.3188780816 0.4974286409 0.6201811857 0.2028166845
##  [86] 0.5635940557 0.3641600924 0.3982048998 0.4430951330 0.7802165953
##  [91] 0.2075854545 0.0567860071 0.6160564655 0.3141170909 0.6556106824
##  [96] 0.8531956084 0.6829191609 0.8755345531 0.7730359458 0.0764580951</code></pre>
</div>
<div id="section-6" class="section level3">
<h3>6</h3>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
</div>
<div id="answer-30" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="co"># 创建一个自定义函数 parallel_lapply</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>parallel_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(input_list, fun, output_type, ...) {</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>  <span class="cf">if</span>(output_type <span class="sc">==</span> <span class="st">&quot;vector&quot;</span>) {</span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">vapply</span>(input_list, fun, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>), ...)</span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(output_type <span class="sc">==</span> <span class="st">&quot;matrix&quot;</span>) {</span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">Map</span>(fun, input_list)), <span class="at">nrow =</span> <span class="fu">length</span>(input_list))</span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Invalid output type. Please specify &#39;vector&#39; or &#39;matrix&#39;.&quot;</span>)</span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a>  }</span>
<span id="cb135-10"><a href="#cb135-10" tabindex="-1"></a>  </span>
<span id="cb135-11"><a href="#cb135-11" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb135-12"><a href="#cb135-12" tabindex="-1"></a>}</span>
<span id="cb135-13"><a href="#cb135-13" tabindex="-1"></a></span>
<span id="cb135-14"><a href="#cb135-14" tabindex="-1"></a><span class="co"># 示例输入列表</span></span>
<span id="cb135-15"><a href="#cb135-15" tabindex="-1"></a>input_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb135-16"><a href="#cb135-16" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" tabindex="-1"></a><span class="co"># 调用 parallel_lapply 函数来计算每个向量的平均值并存储在向量中</span></span>
<span id="cb135-18"><a href="#cb135-18" tabindex="-1"></a>output_vector1 <span class="ot">&lt;-</span> <span class="fu">parallel_lapply</span>(input_list,mean, <span class="st">&quot;vector&quot;</span>)</span>
<span id="cb135-19"><a href="#cb135-19" tabindex="-1"></a>output_vector2 <span class="ot">&lt;-</span> <span class="fu">parallel_lapply</span>(input_list,mean, <span class="st">&quot;matrix&quot;</span>)</span>
<span id="cb135-20"><a href="#cb135-20" tabindex="-1"></a></span>
<span id="cb135-21"><a href="#cb135-21" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb135-22"><a href="#cb135-22" tabindex="-1"></a>output_vector1</span></code></pre></div>
<pre><code>## [1] 2 5 8</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>output_vector2</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    2
## [2,]    5
## [3,]    8</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="co"># 比较parallel_lapply与lapply</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="fu">lapply</span>(input_list,mean)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 2
## 
## [[2]]
## [1] 5
## 
## [[3]]
## [1] 8</code></pre>
</div>
</div>
<div id="question-4-exercise-17.5.1-in-advanced-r" class="section level2">
<h2>Question 4 (Exercise 17.5.1 in “Advanced R”)</h2>
<div id="section-7" class="section level3">
<h3>4</h3>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson\%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson\%27s_chi-squared_test</a>).</p>
</div>
<div id="answer-31" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>  obs <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs)</span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>  </span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>  <span class="co"># 计算期望频数</span></span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a>  exp_freq <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">rowSums</span>(obs), <span class="fu">colSums</span>(obs)) <span class="sc">/</span> n</span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a>  </span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb141-9"><a href="#cb141-9" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> exp_freq)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp_freq)</span>
<span id="cb141-10"><a href="#cb141-10" tabindex="-1"></a>  </span>
<span id="cb141-11"><a href="#cb141-11" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb141-12"><a href="#cb141-12" tabindex="-1"></a>}</span>
<span id="cb141-13"><a href="#cb141-13" tabindex="-1"></a></span>
<span id="cb141-14"><a href="#cb141-14" tabindex="-1"></a><span class="co"># 示例数据</span></span>
<span id="cb141-15"><a href="#cb141-15" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb141-16"><a href="#cb141-16" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb141-17"><a href="#cb141-17" tabindex="-1"></a></span>
<span id="cb141-18"><a href="#cb141-18" tabindex="-1"></a><span class="co"># 调用 fast_chisq_test 函数计算卡方统计量</span></span>
<span id="cb141-19"><a href="#cb141-19" tabindex="-1"></a>chisq_stat <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb141-20"><a href="#cb141-20" tabindex="-1"></a></span>
<span id="cb141-21"><a href="#cb141-21" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb141-22"><a href="#cb141-22" tabindex="-1"></a>chisq_stat</span></code></pre></div>
<pre><code>## [1] 0.1388889</code></pre>
</div>
<div id="section-8" class="section level3">
<h3>5</h3>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
</div>
<div id="answer-32" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>  max_x <span class="ot">&lt;-</span> <span class="fu">max</span>(x)</span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>  max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(y)</span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a>  </span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> max_x, <span class="at">ncol =</span> max_y)</span>
<span id="cb143-6"><a href="#cb143-6" tabindex="-1"></a>  </span>
<span id="cb143-7"><a href="#cb143-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb143-8"><a href="#cb143-8" tabindex="-1"></a>    counts[x[i], y[i]] <span class="ot">&lt;-</span> counts[x[i], y[i]] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb143-9"><a href="#cb143-9" tabindex="-1"></a>  }</span>
<span id="cb143-10"><a href="#cb143-10" tabindex="-1"></a>  </span>
<span id="cb143-11"><a href="#cb143-11" tabindex="-1"></a>  <span class="fu">return</span>(counts)</span>
<span id="cb143-12"><a href="#cb143-12" tabindex="-1"></a>}</span>
<span id="cb143-13"><a href="#cb143-13" tabindex="-1"></a></span>
<span id="cb143-14"><a href="#cb143-14" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb143-15"><a href="#cb143-15" tabindex="-1"></a>  obs <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb143-16"><a href="#cb143-16" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs)</span>
<span id="cb143-17"><a href="#cb143-17" tabindex="-1"></a>  </span>
<span id="cb143-18"><a href="#cb143-18" tabindex="-1"></a>  <span class="co"># 计算期望频数</span></span>
<span id="cb143-19"><a href="#cb143-19" tabindex="-1"></a>  exp_freq <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">rowSums</span>(obs), <span class="fu">colSums</span>(obs)) <span class="sc">/</span> n</span>
<span id="cb143-20"><a href="#cb143-20" tabindex="-1"></a>  </span>
<span id="cb143-21"><a href="#cb143-21" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb143-22"><a href="#cb143-22" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((obs <span class="sc">-</span> exp_freq)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp_freq)</span>
<span id="cb143-23"><a href="#cb143-23" tabindex="-1"></a>  </span>
<span id="cb143-24"><a href="#cb143-24" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb143-25"><a href="#cb143-25" tabindex="-1"></a>}</span>
<span id="cb143-26"><a href="#cb143-26" tabindex="-1"></a></span>
<span id="cb143-27"><a href="#cb143-27" tabindex="-1"></a><span class="co"># 示例数据</span></span>
<span id="cb143-28"><a href="#cb143-28" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb143-29"><a href="#cb143-29" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb143-30"><a href="#cb143-30" tabindex="-1"></a></span>
<span id="cb143-31"><a href="#cb143-31" tabindex="-1"></a><span class="co"># 调用 fast_chisq_test 函数计算卡方统计量</span></span>
<span id="cb143-32"><a href="#cb143-32" tabindex="-1"></a>chisq_stat <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb143-33"><a href="#cb143-33" tabindex="-1"></a></span>
<span id="cb143-34"><a href="#cb143-34" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb143-35"><a href="#cb143-35" tabindex="-1"></a>chisq_stat</span></code></pre></div>
<pre><code>## [1] 0.1388889</code></pre>
</div>
</div>
</div>
<div id="homework-2024-11-18" class="section level1">
<h1>Homework-2024-11-18</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical
Computing with R).</p>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<p>Campare the computation time of the two functions with the function
“microbenchmark”.</p>
</div>
<div id="question-4" class="section level3">
<h3>Question 4</h3>
<p>Comments your results.</p>
</div>
</div>
<div id="answer-33" class="section level2">
<h2>Answer</h2>
<div id="answer-1-1" class="section level3">
<h3>Answer 1</h3>
<p>在之前的作业中，生成练习9.8的马尔科夫链时，R语言代码如下：</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb145-4"><a href="#cb145-4" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb145-5"><a href="#cb145-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb145-6"><a href="#cb145-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb145-7"><a href="#cb145-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb145-8"><a href="#cb145-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb145-9"><a href="#cb145-9" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb145-10"><a href="#cb145-10" tabindex="-1"></a></span>
<span id="cb145-11"><a href="#cb145-11" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.5</span>) <span class="co">#initialize</span></span>
<span id="cb145-12"><a href="#cb145-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb145-13"><a href="#cb145-13" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb145-14"><a href="#cb145-14" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,x2)</span>
<span id="cb145-15"><a href="#cb145-15" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb145-16"><a href="#cb145-16" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb145-17"><a href="#cb145-17" tabindex="-1"></a>} <span class="co"># 已生成马尔科夫链</span></span>
<span id="cb145-18"><a href="#cb145-18" tabindex="-1"></a></span>
<span id="cb145-19"><a href="#cb145-19" tabindex="-1"></a>B <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb145-20"><a href="#cb145-20" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[B<span class="sc">:</span>N, ]</span>
<span id="cb145-21"><a href="#cb145-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Means: &#39;</span>,<span class="fu">round</span>(<span class="fu">colMeans</span>(x),<span class="dv">2</span>))</span>
<span id="cb145-22"><a href="#cb145-22" tabindex="-1"></a></span>
<span id="cb145-23"><a href="#cb145-23" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb145-24"><a href="#cb145-24" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb145-25"><a href="#cb145-25" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(x),<span class="fu">expression</span>(y)),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p>现通过简化，用一个函数实现Gibbs采样：</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a>gibbsSamplingR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, thin) {</span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">10</span>; a <span class="ot">=</span> <span class="dv">1</span>; b <span class="ot">=</span> <span class="dv">1</span>; x <span class="ot">=</span> n<span class="sc">/</span><span class="dv">2</span>; y <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a>      x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a>      y <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a,n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a>    }</span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>  }</span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a>  mat</span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a>}</span></code></pre></div>
<p>沿相同思路，其C++代码如下：</p>
<pre><code>#include &lt;Rcpp.h&gt;
using namespace Rcpp;
// [[Rcpp::export]]
NumericMatrix gibbsSamplingC(int N, int thin) {
  //N = 500; thin = 10
  NumericMatrix mat(N, 2);
  int n = 10;
  double a = 1, b = 1;
  int x = n/2;
  double y = 0.5;
  for(int i = 0; i &lt; N; i++) {
    for(int j = 0; j &lt; thin; j++) {
      x = rbinom(1, n, y)[0];
      y = rbeta(1, x + a,n - x + b)[0];
    }
    mat(i, 0) = x;
    mat(i, 1) = y;
  }
  return(mat);
}</code></pre>
</div>
<div id="answer-2-1" class="section level3">
<h3>Answer 2</h3>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a><span class="fu">library</span>(SA24204187)</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">500</span>; thin <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="fu">gibbsSamplingR</span>(N,thin)</span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a>GibbsC <span class="ot">&lt;-</span> <span class="fu">gibbsSamplingC</span>(N,thin)</span>
<span id="cb148-7"><a href="#cb148-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb148-8"><a href="#cb148-8" tabindex="-1"></a><span class="fu">plot</span>(GibbsR[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index-GibbsR&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb148-9"><a href="#cb148-9" tabindex="-1"></a><span class="fu">lines</span>(GibbsR[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb148-10"><a href="#cb148-10" tabindex="-1"></a><span class="fu">plot</span>(GibbsC[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index-GibbsR&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb148-11"><a href="#cb148-11" tabindex="-1"></a><span class="fu">lines</span>(GibbsC[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>数据确是随机生成的，整个马尔科夫链细节上不同，却在大体上都可看出，似乎两组数据中x均值以及y的均值相同。</p>
</div>
<div id="answer-3-1" class="section level3">
<h3>Answer 3</h3>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb150-3"><a href="#cb150-3" tabindex="-1"></a><span class="fu">library</span>(SA24204187)</span>
<span id="cb150-4"><a href="#cb150-4" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">500</span>; thin <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb150-5"><a href="#cb150-5" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="fu">gibbsSamplingR</span>(N,thin)</span>
<span id="cb150-6"><a href="#cb150-6" tabindex="-1"></a>GibbsC <span class="ot">&lt;-</span> <span class="fu">gibbsSamplingC</span>(N,thin)</span>
<span id="cb150-7"><a href="#cb150-7" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb150-8"><a href="#cb150-8" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">GibbsR =</span> <span class="fu">gibbsSamplingR</span>(N,thin),<span class="at">GibbsC =</span> <span class="fu">gibbsSamplingC</span>(N,thin))</span>
<span id="cb150-9"><a href="#cb150-9" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr       lq   median       uq
## 1 GibbsR 8.987301 9.140951 10.03345
## 2 GibbsC 1.515201 1.535500  1.61465</code></pre>
<p>显而易见，使用相同方法进行Gibbs采样，用Rcpp运行速度是直接用R
的大约九倍。</p>
</div>
<div id="answer-4-1" class="section level3">
<h3>Answer 4</h3>
<p>涉及到多循环、向量化处理数据的编程内容时，用Rcpp运行速度往往快过直接使用R语言运行。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
